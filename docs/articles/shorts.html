<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>shorts: An R Package for Modeling Short Sprints • shorts</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="shorts: An R Package for Modeling Short Sprints">
<meta property="og:description" content="shorts">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shorts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/shorts.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mladenjovanovic/shorts/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="shorts_files/header-attrs-2.5/header-attrs.js"></script><script src="shorts_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="shorts_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="shorts_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>shorts: An R Package for Modeling Short Sprints</h1>
                        <h4 class="author">Mladen Jovanović</h4>
            <address class="author_afil">
      1<br><a class="author_email" href="mailto:#"></a><a href="mailto:coach.mladen.jovanovic@gmail.com" class="email">coach.mladen.jovanovic@gmail.com</a>
      </address>
                              <h4 class="author">Jason D. Vescovi</h4>
            <address class="author_afil">
      2<br><a class="author_email" href="mailto:#"></a><a href="mailto:vescovij@gmail.com" class="email">vescovij@gmail.com</a>
      </address>
                  
            <h4 class="date">2020-12-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mladenjovanovic/shorts/blob/master/vignettes/shorts.Rmd"><code>vignettes/shorts.Rmd</code></a></small>
      <div class="hidden name"><code>shorts.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Short sprint performance is one of the most distinguishable and admired physical trait in sports. Short sprints have been modeled using the mono-exponential equation that involves two parameters: (1) maximum sprinting speed (MSS) and (2) relative acceleration (TAU). The most common methods to assess short sprint performance are with a radar gun or timing gates. In this paper, we: 1) provide the <strong>shorts</strong> package that can model sprint timing data from these two sources; 2) discuss potential issues with assessing sprint time (synchronization and flying start, respectively); and 3) provide model definitions within the <strong>shorts</strong> package to help alleviate errors within the subsequent parameter outcomes.</p>
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Short sprint performance is one of the most distinguishable and admired physical trait in sports. Short sprints, commonly performed in most team sports (e.g., soccer, field hockey, handball, football, etc.), are defined as maximal running from a stand still position over a distance that doesn’t result in deceleration at the end. Peak anaerobic power is achieved within the first few seconds (&lt;5s) of maximal efforts <span class="citation">(Mangine et al. <a href="#ref-mangineSpeedForcePower2014" role="doc-biblioref">2014</a>)</span>, whereas the ability to achieve maximal sprint speed varies based on the type of sport. For example, track and field sprinters are trained to achieve maximal speed later in a race (i.e., 50-60m) <span class="citation">(Ward-Smith <a href="#ref-ward-smithEnergyConversionStrategies2001" role="doc-biblioref">2001</a>)</span>, but team sport athletes have sport-specific attributes and reach it much sooner (i.e., 30-40m)<span class="citation">(Brown, Vescovi, and Vanheest <a href="#ref-brownAssessmentLinearSprinting2004" role="doc-biblioref">2004</a>)</span>. Regardless of the differences in kinematics between athletes, evaluating short sprint performance is routinely included within a battery of fitness tests for a wide range of sports</p>
<p>The use of force plates is considered the gold standard for assessing mechanical properties of sprinting; however, there are logistical and financial challenges to capturing the profile of an entire sprint <span class="citation">(Morin et al. <a href="#ref-morinSimpleMethodComputing2019" role="doc-biblioref">2019</a>; Samozino et al. <a href="#ref-samozinoSimpleMethodMeasuring2016" role="doc-biblioref">2016</a>)</span>. Radar and laser technology are frequently used laboratory-grade methods <span class="citation">(Buchheit et al. <a href="#ref-buchheitMechanicalDeterminantsAcceleration2014" role="doc-biblioref">2014</a>; Edwards et al. <a href="#ref-edwardsSprintAccelerationCharacteristics2020" role="doc-biblioref">2020</a>; Jiménez-Reyes et al. <a href="#ref-jimenez-reyesRelationshipVerticalHorizontal2018" role="doc-biblioref">2018</a>; Marcote-Pequeño et al. <a href="#ref-marcote-pequenoAssociationForceVelocity2019" role="doc-biblioref">2019</a>)</span> but not normally accessible to practitioners working in sports. Undoubtedly, the most common method available and used to evaluate sprint performance are timing gates. Often multiple gates are positioned at varying distances to capture split times (e.g., 5, 10, 20m), which can now be incorporated into the method for determining sprint mechanical properties <span class="citation">(Morin et al. <a href="#ref-morinSimpleMethodComputing2019" role="doc-biblioref">2019</a>; Samozino et al. <a href="#ref-samozinoSimpleMethodMeasuring2016" role="doc-biblioref">2016</a>)</span>. This approach presents an advantage to practitioners who can use the outcomes to describe individual differences, quantify the effects of training interventions, and better understanding the limiting factors of performance. The <strong>shorts</strong> package <span class="citation">(Jovanovic <a href="#ref-R-shorts" role="doc-biblioref">2020</a>)</span>, written in the R language <span class="citation">(R Core Team <a href="#ref-R-base" role="doc-biblioref">2020</a>)</span>, represents an open-source tool to help sport scientists translate raw timing data into detailed mechanical outcomes through mathematical modeling <span class="citation">(Morin et al. <a href="#ref-morinSimpleMethodComputing2019" role="doc-biblioref">2019</a>; Samozino et al. <a href="#ref-samozinoSimpleMethodMeasuring2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>In the current paper, we will provide an explanation of one commonly used mathematical equation to model short sprints, modeling applications using the <strong>shorts</strong> package, issues that can arise during measurement and estimation, and potential solutions to those problems.</p>
</div>
<div id="mathematical-model" class="section level1">
<h1 class="hasAnchor">
<a href="#mathematical-model" class="anchor"></a>Mathematical model</h1>
<p>Short sprints have been modeled using the mono-exponential equation @ref(eq:velocity-time) originally proposed by <span class="citation">Furusawa, Hill, and Parkinson (<a href="#ref-doi:10.1098/rspb.1927.0035" role="doc-biblioref">1927</a>)</span>, and more recently popularized by <span class="citation">Clark et al. (<a href="#ref-clarkNFLCombine40Yard2017" role="doc-biblioref">2017</a>)</span>, and <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2016" role="doc-biblioref">2016</a>)</span>. Equation @ref(eq:velocity-time) represents function for instantaneous horizontal velocity <span class="math inline">\(v\)</span> given the time <span class="math inline">\(t\)</span> and two model parameters:</p>
<p><span class="math display">\[\begin{equation}
  v(t) = MSS \times (1 - e^{-\frac{t}{TAU}}) (\#eq:velocity-time)
\end{equation}\]</span></p>
<p>The parameters of the equation @ref(eq:velocity-time) are  (MSS; expressed in <span class="math inline">\(ms^{-1}\)</span>) and  (TAU). Mathematically, TAU represents the ratio of MSS to initial acceleration (MAC; , expressed in <span class="math inline">\(ms^{-2}\)</span>) @ref(eq:maximal-acceleration).</p>
<p><span class="math display">\[\begin{equation}
  MAC = \frac{MSS}{TAU}(\#eq:maximal-acceleration)
\end{equation}\]</span></p>
<p>Although TAU is used in the equations, and later estimated, it is preferred to use MAC instead since it is easier to grasp, particularly for less math inclined coaches.</p>
<p>By derivating equation @ref(eq:velocity-time), we can get equation for horizontal acceleration @ref(eq:acceleration-time).</p>
<p><span class="math display">\[\begin{equation}
  a(t) = \frac{MSS}{TAU} \times e^{-\frac{t}{TAU}}  (\#eq:acceleration-time)
\end{equation}\]</span></p>
<p>By integrating equation @ref(eq:velocity-time), we can get equation for distance covered @ref(eq:distance-time).</p>
<p><span class="math display">\[\begin{equation}
  d(t) = MSS \times (t + TAU \times e^{-\frac{t}{TAU}}) - MSS \times TAU  (\#eq:distance-time)
\end{equation}\]</span></p>
<p>Let’s consider four athletes with different levels of MSS (high versus low maximal sprinting speed) and MAC (high versus low maximal acceleration; as mentioned previously, using MAC is preferred over using TAU) (Table @ref(tab:four-athletes-table)).</p>
<table class="table">
<caption>Four athletes with different MSS and MAC parameters.</caption>
<thead><tr class="header">
<th align="left">Athlete</th>
<th align="right">MSS</th>
<th align="right">MAC</th>
<th align="right">TAU</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Athlete A</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">1.20</td>
</tr>
<tr class="even">
<td align="left">Athlete B</td>
<td align="right">12</td>
<td align="right">6</td>
<td align="right">2.00</td>
</tr>
<tr class="odd">
<td align="left">Athlete C</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">0.80</td>
</tr>
<tr class="even">
<td align="left">Athlete D</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">1.33</td>
</tr>
</tbody>
</table>
<p>Figure @ref(fig:four-athletes-kinematics) depicts distance, velocity, and acceleration over time (from 0 to 6s).</p>
<div class="figure" style="text-align: center">
<img src="shorts_files/figure-html/four-athletes-kinematics-1.png" alt="Kinematic characteristic of four athletes with different MSS and MAC parameters over a period of 0 to 6seconds." width="100%"><p class="caption">
Kinematic characteristic of four athletes with different MSS and MAC parameters over a period of 0 to 6seconds.
</p>
</div>
<p>Plotting acceleration against velocity (Figure @ref(fig:four-athletes-profile)), we will get Acceleration-Velocity profile, which is linear, according to the mathematical model.</p>
<div class="figure" style="text-align: center">
<img src="shorts_files/figure-html/four-athletes-profile-1.png" alt="Acceleration-Velocity profile of four athletes with different MSS and MAC parameters." width="100%"><p class="caption">
Acceleration-Velocity profile of four athletes with different MSS and MAC parameters.
</p>
</div>
</div>
<div id="estimation-using-shorts-package" class="section level1">
<h1 class="hasAnchor">
<a href="#estimation-using-shorts-package" class="anchor"></a>Estimation using shorts package</h1>
<p>Short sprints profiling is usually performed by: (1) measuring split times using timing gates (i.e., positioned at various distances, e.g., 5, 10, 20, 30, 40m), (2) getting a velocity trace using a radar gun. Estimation of MSS and TAU parameters from equation @ref(eq:velocity-time) is performed in <strong>shorts</strong> package using non-linear least squares regression implemented in the <code>nls</code> function in the <strong>base</strong> R <span class="citation">(R Core Team <a href="#ref-R-base" role="doc-biblioref">2020</a>)</span> and <code>nlme</code> function in the <strong>nlme</strong> package <span class="citation">(Pinheiro, Bates, and R-core <a href="#ref-R-nlme" role="doc-biblioref">2020</a>)</span> for the mixed-effect models.</p>
<div id="estimating-short-sprint-parameters-using-split-times" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-short-sprint-parameters-using-split-times" class="anchor"></a>Estimating short sprint parameters using split times</h2>
<p>Let’s consider an example of an athlete with MSS equal to 9 <span class="math inline">\(ms^-1\)</span>, TAU equal to 1.3, and MAC equal to 6.92 <span class="math inline">\(ms^-2\)</span> performing 40m sprint with timing gates positioned at each 10m split. For split times, distance is a predictor, and time is the outcome variable, thus the equation @ref(eq:velocity-time) becomes:</p>
<p><span class="math display">\[\begin{equation}
  t(d) = TAU \times W(-e^{\frac{-d}{MSS \times TAU}} - 1) + \frac{d}{MSS} + TAU (\#eq:time-distance)
\end{equation}\]</span></p>
<p><span class="math inline">\(W\)</span> in equation @ref(eq:time-distance) represents Lambert’s W function <span class="citation">(Goerg <a href="#ref-R-LambertW" role="doc-biblioref">2020</a>)</span>. MSS and TAU parameters are estimated using <code>model_using_splits</code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://mladenjovanovic.github.io/shorts/">shorts</a></span><span class="op">)</span>

<span class="va">split_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span><span class="op">)</span>

<span class="va">split_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.17</span>, <span class="fl">3.43</span>, <span class="fl">4.60</span>, <span class="fl">5.73</span><span class="op">)</span>

<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_distance</span>,
  time <span class="op">=</span> <span class="va">split_time</span>
<span class="op">)</span>

<span class="va">m1</span>
<span class="co">#&gt; Estimated model parameters</span>
<span class="co">#&gt; --------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                9.01                1.31                6.89 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               15.52                0.00                0.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;   0.00249   1.00000  -0.00178   0.00265   0.00265   0.00176 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;   0.00157   0.04742</span></code></pre></div>
<p>Maximal relative power (PMAX) from the output is estimated using <span class="math inline">\(\frac{MSS \times MAC}{4}\)</span>, which disregards the air resistance. <code>time_correction</code> and <code>distance_corection</code> parameters will be covered later in the article.</p>
<p>Besides providing <em>residual standard error</em> (RSE), <strong>shorts</strong> functions provide additional model fit estimators. Additional information can be gained by exploring the returned object, particularly object returned from the <code>nls</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Formula: corrected_time ~ TAU * I(LambertW::W(-exp(1)^(-distance/(MSS * </span>
<span class="co">#&gt;     TAU) - 1))) + distance/MSS + TAU</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameters:</span>
<span class="co">#&gt;     Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; MSS   9.0121     0.0155     581  3.0e-06 ***</span>
<span class="co">#&gt; TAU   1.3083     0.0066     198  2.5e-05 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.00249 on 2 degrees of freedom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of iterations to convergence: 4 </span>
<span class="co">#&gt; Achieved convergence tolerance: 3.11e-06</span></code></pre></div>
<p>Once we have estimated MSS and TAU, we can use <code>predict_</code> family of functions to predict various relationships (i.e. time at distance, acceleration at distance, velocity at time):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Predict time at distance</span>
<span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_distance</span>,
  MSS <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 2.17 3.43 4.60 5.73</span>

<span class="co"># Predict acceleration at time</span>
<span class="fu"><a href="../reference/predict_kinematics.html">predict_acceleration_at_time</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,
  MSS <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 6.8884 3.2075 1.4935 0.6954 0.3238 0.1508 0.0702</span></code></pre></div>
<div id="air-resistance-and-the-calculation-of-force-and-mechanical-power" class="section level3">
<h3 class="hasAnchor">
<a href="#air-resistance-and-the-calculation-of-force-and-mechanical-power" class="anchor"></a>Air resistance and the calculation of force and mechanical power</h3>
<p>To estimate force production at distance or time (using <code>predict_force_at_distance</code> and <code>predict_force_at_time</code> functions), as well as power production (using <code>predict_power_at_distance</code> and <code>predict_power_at_time</code> functions), one needs to take into account the air resistance. Air resistance (N) is estimated using <code>get_air_resistance</code> function, which takes velocity, body mass (kg), body height (m), barometric pressure (Torr), air temperature (<span class="math inline">\(C^\circ\)</span>), and wind velocity (<span class="math inline">\(ms^-1\)</span>) as parameters (please refer to <span class="citation">Arsac and Locatelli (<a href="#ref-arsacModelingEnergetics100m2002" role="doc-biblioref">2002</a>)</span>, <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2016" role="doc-biblioref">2016</a>)</span>, and <span class="citation">van Ingen Schenau, Jacobs, and de Koning (<a href="#ref-vaningenschenauCanCyclePower1991" role="doc-biblioref">1991</a>)</span> for more information):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_air_resistance.html">get_air_resistance</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="fl">5</span>,
  bodymass <span class="op">=</span> <span class="fl">80</span>,
  bodyheight <span class="op">=</span> <span class="fl">1.85</span>,
  barometric_pressure <span class="op">=</span> <span class="fl">780</span>,
  air_temperature <span class="op">=</span> <span class="fl">20</span>,
  wind_velocity <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 6.1</span></code></pre></div>
<p>When estimating force and power, the air resistance parameters can be set using <code>"..."</code>, which are forwarded to the <code>get_air_resistance</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To calculate horizontal force produced</span>
<span class="fu"><a href="../reference/predict_kinematics.html">predict_force_at_distance</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_distance</span>,
  MSS <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>,
  <span class="co"># Additional parameters forwarded to get_air_resistance</span>
  <span class="co"># Otherwise, defaults are used</span>
  bodymass <span class="op">=</span> <span class="fl">80</span>,
  bodyheight <span class="op">=</span> <span class="fl">1.85</span>,
  barometric_pressure <span class="op">=</span> <span class="fl">780</span>,
  air_temperature <span class="op">=</span> <span class="fl">20</span>,
  wind_velocity <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 119.0  58.6  36.9  28.2</span>

<span class="co"># To calculate power produced</span>
<span class="fu"><a href="../reference/predict_kinematics.html">predict_power_at_distance</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_distance</span>,
  MSS <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>,
  <span class="co"># Additional parameters forwarded to get_air_resistance</span>
  <span class="co"># Otherwise, defaults are used</span>
  bodymass <span class="op">=</span> <span class="fl">80</span>,
  bodyheight <span class="op">=</span> <span class="fl">1.85</span>,
  barometric_pressure <span class="op">=</span> <span class="fl">780</span>,
  air_temperature <span class="op">=</span> <span class="fl">20</span>,
  wind_velocity <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 868 490 323 251</span></code></pre></div>
<p>The easiest way to get all kinematics for short sprints is to use <code>predict_kinematics</code> functions:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_kinematics</a></span><span class="op">(</span>
  <span class="va">m1</span>,
  max_time <span class="op">=</span> <span class="fl">6</span>,
  frequency <span class="op">=</span> <span class="fl">100</span>,
  <span class="co"># Additional parameters forwarded to get_air_resistance</span>
  <span class="co"># Otherwise, defaults are used</span>
  bodymass <span class="op">=</span> <span class="fl">80</span>,
  bodyheight <span class="op">=</span> <span class="fl">1.85</span>,
  barometric_pressure <span class="op">=</span> <span class="fl">780</span>,
  air_temperature <span class="op">=</span> <span class="fl">20</span>,
  wind_velocity <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt;   time distance velocity acceleration bodymass</span>
<span class="co">#&gt; 1 0.00 0.000000   0.0000         6.89       80</span>
<span class="co">#&gt; 2 0.01 0.000344   0.0686         6.84       80</span>
<span class="co">#&gt; 3 0.02 0.001371   0.1367         6.78       80</span>
<span class="co">#&gt; 4 0.03 0.003076   0.2043         6.73       80</span>
<span class="co">#&gt; 5 0.04 0.005455   0.2714         6.68       80</span>
<span class="co">#&gt; 6 0.05 0.008502   0.3379         6.63       80</span>
<span class="co">#&gt;   net_horizontal_force air_resistance horizontal_force</span>
<span class="co">#&gt; 1                  551        0.07536              551</span>
<span class="co">#&gt; 2                  547        0.05609              547</span>
<span class="co">#&gt; 3                  543        0.03978              543</span>
<span class="co">#&gt; 4                  539        0.02636              539</span>
<span class="co">#&gt; 5                  534        0.01576              534</span>
<span class="co">#&gt; 6                  530        0.00792              530</span>
<span class="co">#&gt;   horizontal_force_relative vertical_force resultant_force</span>
<span class="co">#&gt; 1                      6.89            785             959</span>
<span class="co">#&gt; 2                      6.84            785             957</span>
<span class="co">#&gt; 3                      6.78            785             954</span>
<span class="co">#&gt; 4                      6.73            785             952</span>
<span class="co">#&gt; 5                      6.68            785             950</span>
<span class="co">#&gt; 6                      6.63            785             947</span>
<span class="co">#&gt;   resultant_force_relative power relative_power    RF</span>
<span class="co">#&gt; 1                     12.0   0.0          0.000 0.575</span>
<span class="co">#&gt; 2                     12.0  37.5          0.469 0.572</span>
<span class="co">#&gt; 3                     11.9  74.2          0.928 0.569</span>
<span class="co">#&gt; 4                     11.9 110.0          1.375 0.566</span>
<span class="co">#&gt; 5                     11.9 145.0          1.813 0.563</span>
<span class="co">#&gt; 6                     11.8 179.2          2.241 0.560</span>
<span class="co">#&gt;   force_angle</span>
<span class="co">#&gt; 1        54.9</span>
<span class="co">#&gt; 2        55.1</span>
<span class="co">#&gt; 3        55.3</span>
<span class="co">#&gt; 4        55.5</span>
<span class="co">#&gt; 5        55.7</span>
<span class="co">#&gt; 6        55.9</span></code></pre></div>
<p>Plotting the model predictions can be done once we convert data from wide to long with the help of <strong>ggplot2</strong> <span class="citation">(Wickham, Chang, et al. <a href="#ref-R-ggplot2" role="doc-biblioref">2020</a>)</span>, <strong>dplyr</strong> <span class="citation">(Wickham, François, et al. <a href="#ref-R-dplyr" role="doc-biblioref">2020</a>)</span>, <strong>tidyr</strong> <span class="citation">(Wickham <a href="#ref-R-tidyr" role="doc-biblioref">2020</a>)</span>, and <strong>tidyverse</strong> <span class="citation">(Wickham <a href="#ref-R-tidyverse" role="doc-biblioref">2019</a>)</span> packages:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, cols <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="utility-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#utility-functions" class="anchor"></a>Utility functions</h3>
<p>Another valuable addition for sport scientists and coaches is the ability to determine the distances and times where 90% of maximum sprinting speed is reached, or where peak power is within 90% range. To identify these values, <strong>shorts</strong> package comes with <code>find_</code> family of functions:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Finds distance where 90% of maximum sprinting speed is reached</span>
<span class="fu"><a href="../reference/find_functions.html">find_velocity_critical_distance</a></span><span class="op">(</span>
  MSS <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>,
  percent <span class="op">=</span> <span class="fl">0.9</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 16.5</span>

<span class="co"># Finds maximal power and distance (this time using air resistance)</span>
<span class="fu"><a href="../reference/find_functions.html">find_max_power_distance</a></span><span class="op">(</span>
  MSS <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>,
  <span class="co"># Additional parameters forwarded to get_air_resistance</span>
  <span class="co"># Otherwise, defaults are used</span>
  bodymass <span class="op">=</span> <span class="fl">80</span>,
  bodyheight <span class="op">=</span> <span class="fl">1.85</span>,
  barometric_pressure <span class="op">=</span> <span class="fl">780</span>,
  air_temperature <span class="op">=</span> <span class="fl">20</span>,
  wind_velocity <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>
<span class="co">#&gt; $max_power</span>
<span class="co">#&gt; [1] 1264</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $distance</span>
<span class="co">#&gt; [1] 2.46</span>

<span class="co"># Finds distance over 90% power range</span>
<span class="fu"><a href="../reference/find_functions.html">find_power_critical_distance</a></span><span class="op">(</span>
  MSS <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m1</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>,
  <span class="co"># Additional parameters forwarded to get_air_resistance</span>
  <span class="co"># Otherwise, defaults are used</span>
  bodymass <span class="op">=</span> <span class="fl">80</span>,
  bodyheight <span class="op">=</span> <span class="fl">1.85</span>,
  barometric_pressure <span class="op">=</span> <span class="fl">780</span>,
  air_temperature <span class="op">=</span> <span class="fl">20</span>,
  wind_velocity <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>
<span class="co">#&gt; $lower</span>
<span class="co">#&gt; [1] 0.959</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $upper</span>
<span class="co">#&gt; [1] 5.44</span></code></pre></div>
</div>
<div id="mixed-effects-model" class="section level3">
<h3 class="hasAnchor">
<a href="#mixed-effects-model" class="anchor"></a>Mixed-effects model</h3>
<p>Sprint performance is often evaluated with a group of athletes (e.g., soccer club) representing a single strata of interest. Sports scientists can estimate individual profiles, or utilize mixed-effects models. To perform mixed-effects models in <strong>shorts</strong> for split times, one can use <code>mixed_model_using_splits</code> function. To demonstrate this functionality, we load the <code>split_times</code> dataset provided in the <strong>shorts</strong> package:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">split_times</span><span class="op">)</span>

<span class="co"># Mixed model</span>
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_split_times.html">mixed_model_using_splits</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">split_times</span>,
  distance <span class="op">=</span> <span class="st">"distance"</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  athlete <span class="op">=</span> <span class="st">"athlete"</span>,

  <span class="co"># Select random effects</span>
  <span class="co"># Default is MSS and TAU</span>
  random <span class="op">=</span> <span class="va">MSS</span> <span class="op">+</span> <span class="va">TAU</span> <span class="op">~</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="va">m2</span>
<span class="co">#&gt; Estimated fixed model parameters</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;               8.065               0.655              12.309 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;              24.818               0.000               0.000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimated random model parameters</span>
<span class="co">#&gt; ----------------------------------</span>
<span class="co">#&gt;     athlete  MSS   TAU  MAC PMAX time_correction</span>
<span class="co">#&gt; 1     James 9.69 0.847 11.4 27.7               0</span>
<span class="co">#&gt; 2       Jim 7.83 0.505 15.5 30.4               0</span>
<span class="co">#&gt; 3      John 7.78 0.727 10.7 20.8               0</span>
<span class="co">#&gt; 4 Kimberley 8.57 0.802 10.7 22.9               0</span>
<span class="co">#&gt; 5  Samantha 6.45 0.395 16.3 26.4               0</span>
<span class="co">#&gt;   distance_correction</span>
<span class="co">#&gt; 1                   0</span>
<span class="co">#&gt; 2                   0</span>
<span class="co">#&gt; 3                   0</span>
<span class="co">#&gt; 4                   0</span>
<span class="co">#&gt; 5                   0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;    0.0260    0.9998   -0.0293    0.0496    0.0496    0.0214 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;    0.0172    0.9019</span></code></pre></div>
<p>Additional information about mixed-effects model performed using the <code>nlme</code> package <span class="citation">(Pinheiro, Bates, and R-core <a href="#ref-R-nlme" role="doc-biblioref">2020</a>)</span> can be obtained using <code>summary</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>
<span class="co">#&gt; Nonlinear mixed-effects model fit by maximum likelihood</span>
<span class="co">#&gt;   Model: corrected_time ~ TAU * I(LambertW::W(-exp(1)^(-distance/(MSS *      TAU) - 1))) + distance/MSS + TAU </span>
<span class="co">#&gt;  Data: train </span>
<span class="co">#&gt;     AIC   BIC logLik</span>
<span class="co">#&gt;   -75.1 -66.7   43.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Random effects:</span>
<span class="co">#&gt;  Formula: list(MSS ~ 1, TAU ~ 1)</span>
<span class="co">#&gt;  Level: athlete</span>
<span class="co">#&gt;  Structure: General positive-definite, Log-Cholesky parametrization</span>
<span class="co">#&gt;          StdDev Corr </span>
<span class="co">#&gt; MSS      1.066  MSS  </span>
<span class="co">#&gt; TAU      0.178  0.877</span>
<span class="co">#&gt; Residual 0.026       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fixed effects: MSS + TAU ~ 1 </span>
<span class="co">#&gt;     Value Std.Error DF t-value p-value</span>
<span class="co">#&gt; MSS  8.06     0.495 24   16.30       0</span>
<span class="co">#&gt; TAU  0.66     0.084 24    7.82       0</span>
<span class="co">#&gt;  Correlation: </span>
<span class="co">#&gt;     MSS  </span>
<span class="co">#&gt; TAU 0.874</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Standardized Within-Group Residuals:</span>
<span class="co">#&gt;    Min     Q1    Med     Q3    Max </span>
<span class="co">#&gt; -1.909 -0.605  0.154  0.523  1.129 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Observations: 30</span>
<span class="co">#&gt; Number of Groups: 5</span></code></pre></div>
<p>The following figure contains kinematics for all athletes in <code>split_times</code> dataset. Please note that power calculation takes default parameters for each individual:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_kinematics</a></span><span class="op">(</span><span class="va">m2</span>, max_time <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">df</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">distance</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">athlete</span>, color <span class="op">=</span> <span class="va">athlete</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"top"</span>,
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="estimating-short-sprint-parameters-using-radar-gun" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-short-sprint-parameters-using-radar-gun" class="anchor"></a>Estimating short sprint parameters using radar gun</h2>
<p>Estimation of the short sprint profile using radar gun data takes time as predictor and velocity as the outcome variable. Thus equation @ref(eq:velocity-time) is used to estimate MSS and TAU.</p>
<p>Let’s consider the same example of an athlete with MSS equal to 9<span class="math inline">\(ms^-1\)</span>, TAU equal to 1.3, and MAC equal to 6.92<span class="math inline">\(ms^-2\)</span> performing 40m sprint with velocity estimated using radar run (in this case with 1Hz sampling rate).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sprint_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">sprint_velocity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.00</span>, <span class="fl">4.83</span>, <span class="fl">7.07</span>, <span class="fl">8.10</span>, <span class="fl">8.59</span>, <span class="fl">8.81</span>, <span class="fl">8.91</span><span class="op">)</span>

<span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_radar.html">model_using_radar</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="va">sprint_velocity</span>,
  time <span class="op">=</span> <span class="va">sprint_time</span>
<span class="op">)</span>

<span class="va">m3</span>
<span class="co">#&gt; Estimated model parameters</span>
<span class="co">#&gt; --------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                9.00                1.30                6.92 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               15.58                0.00                0.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;   0.00327   1.00000  -0.00406   0.00532   0.00532   0.00276 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;   0.00207       NaN</span></code></pre></div>
<p>Both split and radar gun models allow the use of <em>weighted</em> non-linear regression. For example, we can give more weight to shorter distance or faster velocities. Weighted non-linear regression is performed by setting <code>weights</code> parameter:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m3_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_radar.html">model_using_radar</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="va">sprint_velocity</span>,
  time <span class="op">=</span> <span class="va">sprint_time</span>,
  weights <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">sprint_velocity</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">m3_weighted</span>
<span class="co">#&gt; Estimated model parameters</span>
<span class="co">#&gt; --------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                9.00                1.30                6.92 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               15.58                0.00                0.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;   0.00108   1.00000  -0.00406   0.00534   0.00534   0.00276 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;   0.00206       NaN</span></code></pre></div>
<div id="mixed-effects-model-1" class="section level3">
<h3 class="hasAnchor">
<a href="#mixed-effects-model-1" class="anchor"></a>Mixed-effects model</h3>
<p>Mixed-effects model using radar data is done using <code>mixed_model_using_radar</code> function. To perform mixed model, let’s load data that comes with <strong>shorts</strong> package.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"radar_gun_data"</span><span class="op">)</span>

<span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_radar.html">mixed_model_using_radar</a></span><span class="op">(</span>
  <span class="va">radar_gun_data</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  velocity <span class="op">=</span> <span class="st">"velocity"</span>,
  athlete <span class="op">=</span> <span class="st">"athlete"</span>
<span class="op">)</span>

<span class="va">m4</span>
<span class="co">#&gt; Estimated fixed model parameters</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                8.30                1.01                8.24 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               17.09                0.00                0.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimated random model parameters</span>
<span class="co">#&gt; ----------------------------------</span>
<span class="co">#&gt;     athlete   MSS   TAU  MAC PMAX time_correction</span>
<span class="co">#&gt; 1     James 10.00 1.111 9.00 22.5               0</span>
<span class="co">#&gt; 2       Jim  8.00 0.889 9.00 18.0               0</span>
<span class="co">#&gt; 3      John  8.00 1.069 7.48 15.0               0</span>
<span class="co">#&gt; 4 Kimberley  9.01 1.286 7.01 15.8               0</span>
<span class="co">#&gt; 5  Samantha  6.50 0.685 9.50 15.4               0</span>
<span class="co">#&gt;   distance_correction</span>
<span class="co">#&gt; 1                   0</span>
<span class="co">#&gt; 2                   0</span>
<span class="co">#&gt; 3                   0</span>
<span class="co">#&gt; 4                   0</span>
<span class="co">#&gt; 5                   0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;    0.0516    0.9994   -0.2191    0.1983    0.2191    0.0516 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;    0.0395       NaN</span></code></pre></div>
</div>
</div>
</div>
<div id="problems-with-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#problems-with-estimation" class="anchor"></a>Problems with estimation</h1>
<p>There is a challenge when collecting sprint data that could have a substantial impact on modeled outcomes. To ensure accurate parameter outcomes, the initial force production must be synced with start time <span class="citation">(Thomas A. Haugen, Breitschädel, and Samozino <a href="#ref-haugenPowerForceVelocityProfilingSprinting2020" role="doc-biblioref">2020</a>; Haugen, Breitschädel, and Seiler <a href="#ref-haugenSprintMechanicalVariables2019" role="doc-biblioref">2019</a>)</span>. Below we describe this challenge when using radar guns or timing gates and suggest potential solutions within the <strong>shorts</strong> package.</p>
<div id="problems-with-time-sync-with-radar-gun" class="section level2">
<h2 class="hasAnchor">
<a href="#problems-with-time-sync-with-radar-gun" class="anchor"></a>Problems with time sync with radar gun</h2>
<p>One source of error in the modeled estimation using a radar gun is the time synchronization. In theory, synchronization is ideal when a sprint is initiated at <span class="math inline">\(t=0\)</span> (i.e., <span class="math inline">\(v(t=0) = 0\)</span>). In practice, this is often not the case. Let’s use our athlete and add and deduct 0.5s to simulate an error in synchronization and its effect on estimated MSS and TAU.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  `true time` <span class="op">=</span> <span class="va">sprint_time</span>,
  velocity <span class="op">=</span> <span class="va">sprint_velocity</span>,
  `0.5s added` <span class="op">=</span> <span class="va">`true time`</span> <span class="op">+</span> <span class="fl">0.5</span>,
  `0.5s deducted` <span class="op">=</span> <span class="va">`true time`</span> <span class="op">-</span> <span class="fl">0.5</span>
<span class="op">)</span>

<span class="va">plot_df</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">df</span>, cols <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, names_to <span class="op">=</span> <span class="st">"Sync issue"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">plot_df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="va">velocity</span>, color <span class="op">=</span> <span class="va">`Sync issue`</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Time (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Velocity ("</span> <span class="op">*</span> <span class="va">ms</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following three models estimate MSS and TAU from the three datasets:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Without synchronization issues</span>
<span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_radar.html">model_using_radar</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">velocity</span>,
  time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">`true time`</span>
<span class="op">)</span>

<span class="co"># With time added</span>
<span class="va">m6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_radar.html">model_using_radar</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">velocity</span>,
  time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">`0.5s added`</span>
<span class="op">)</span>

<span class="co"># With time deducted</span>
<span class="va">m7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_radar.html">model_using_radar</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">velocity</span>,
  time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">`0.5s deducted`</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"True time"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m5</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Added 0.5s time"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m6</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Deducted 0.5s time"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m7</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt;                model   MSS  TAU  MAC PMAX time_correction</span>
<span class="co">#&gt; 1          True time  9.00 1.30 6.92 15.6               0</span>
<span class="co">#&gt; 2    Added 0.5s time  9.91 2.34 4.23 10.5               0</span>
<span class="co">#&gt; 3 Deducted 0.5s time 10.08 1.86 5.43 13.7               0</span>
<span class="co">#&gt;   distance_correction</span>
<span class="co">#&gt; 1                   0</span>
<span class="co">#&gt; 2                   0</span>
<span class="co">#&gt; 3                   0</span></code></pre></div>
<p>As can be seen from the example, TAU is affected by an error in synchronization of time with velocity. The potential solution incorporated into the <strong>shorts</strong> package involves estimation of the <em>time correction</em> parameter using the following equation:</p>
<p><span class="math display">\[\begin{equation}
  v(t) = MSS \times (1 - e^{-\frac{t + time \; correction}{TAU}}) (\#eq:velocity-time-correction)
\end{equation}\]</span></p>
<p>This model is incorporated in the <code>model_using_radar_with_time_correction</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># With time added</span>
<span class="va">m8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_radar.html">model_using_radar_with_time_correction</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">velocity</span>,
  time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">`0.5s added`</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m8</span><span class="op">)</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                9.00                1.30                6.92 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               15.58               -0.50                0.00</span>

<span class="co"># With time deducted</span>
<span class="va">m9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_radar.html">model_using_radar_with_time_correction</a></span><span class="op">(</span>
  velocity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">velocity</span>,
  time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">`0.5s deducted`</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m9</span><span class="op">)</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                9.00                1.30                6.92 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               15.58                0.50                0.00</span></code></pre></div>
<p>When using <code>predict_</code> family of functions, one can provide estimated time correction to get predictions at original time scale.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using the true time</span>
<span class="fu"><a href="../reference/predict_kinematics.html">predict_velocity_at_time</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">`true time`</span>,
  MSS <span class="op">=</span> <span class="va">m5</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m5</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 0.00 4.83 7.07 8.11 8.59 8.81 8.91</span>

<span class="co"># Using time with sync issues</span>
<span class="fu"><a href="../reference/predict_kinematics.html">predict_velocity_at_time</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">`0.5s added`</span>,
  MSS <span class="op">=</span> <span class="va">m8</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
  TAU <span class="op">=</span> <span class="va">m8</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>,
  time_correction <span class="op">=</span> <span class="va">m8</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">time_correction</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 7.82e-05 4.83e+00 7.07e+00 8.11e+00 8.59e+00 8.81e+00</span>
<span class="co">#&gt; [7] 8.91e+00</span></code></pre></div>
<div id="mixed-model-approach" class="section level3">
<h3 class="hasAnchor">
<a href="#mixed-model-approach" class="anchor"></a>Mixed-model approach</h3>
<p>When it comes to mixed-model approach, time correction can be modeled as a fixed effect or random effect using the <code>mixed_model_using_radar_with_time_correction</code> function.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Adding 0.5s to radar_gun_data</span>
<span class="va">radar_gun_data</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">radar_gun_data</span><span class="op">$</span><span class="va">time</span> <span class="op">+</span> <span class="fl">0.5</span>

<span class="co"># Mixed model with time correction being fixed effect</span>
<span class="va">m10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_radar.html">mixed_model_using_radar_with_time_correction</a></span><span class="op">(</span>
  <span class="va">radar_gun_data</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  velocity <span class="op">=</span> <span class="st">"velocity"</span>,
  athlete <span class="op">=</span> <span class="st">"athlete"</span>,
  random <span class="op">=</span> <span class="va">MSS</span> <span class="op">+</span> <span class="va">TAU</span> <span class="op">~</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="va">m10</span>
<span class="co">#&gt; Estimated fixed model parameters</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                8.30                1.01                8.24 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               17.10               -0.50                0.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimated random model parameters</span>
<span class="co">#&gt; ----------------------------------</span>
<span class="co">#&gt;     athlete   MSS   TAU  MAC PMAX time_correction</span>
<span class="co">#&gt; 1     James 10.00 1.111 9.00 22.5            -0.5</span>
<span class="co">#&gt; 2       Jim  8.00 0.889 9.00 18.0            -0.5</span>
<span class="co">#&gt; 3      John  8.00 1.069 7.48 15.0            -0.5</span>
<span class="co">#&gt; 4 Kimberley  9.01 1.285 7.01 15.8            -0.5</span>
<span class="co">#&gt; 5  Samantha  6.50 0.685 9.50 15.4            -0.5</span>
<span class="co">#&gt;   distance_correction</span>
<span class="co">#&gt; 1                   0</span>
<span class="co">#&gt; 2                   0</span>
<span class="co">#&gt; 3                   0</span>
<span class="co">#&gt; 4                   0</span>
<span class="co">#&gt; 5                   0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;    0.0516    0.9994   -0.2190    0.1983    0.2190    0.0516 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;    0.0395       Inf</span>

<span class="co"># Mixed model with time correction being random effect</span>
<span class="va">m11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_radar.html">mixed_model_using_radar_with_time_correction</a></span><span class="op">(</span>
  <span class="va">radar_gun_data</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  velocity <span class="op">=</span> <span class="st">"velocity"</span>,
  athlete <span class="op">=</span> <span class="st">"athlete"</span>,
  random <span class="op">=</span> <span class="va">MSS</span> <span class="op">+</span> <span class="va">TAU</span> <span class="op">+</span> <span class="va">time_correction</span> <span class="op">~</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="va">m11</span>
<span class="co">#&gt; Estimated fixed model parameters</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;                8.30                1.01                8.24 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;               17.10               -0.50                0.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimated random model parameters</span>
<span class="co">#&gt; ----------------------------------</span>
<span class="co">#&gt;     athlete   MSS   TAU  MAC PMAX time_correction</span>
<span class="co">#&gt; 1     James 10.00 1.110 9.00 22.5            -0.5</span>
<span class="co">#&gt; 2       Jim  8.00 0.889 9.00 18.0            -0.5</span>
<span class="co">#&gt; 3      John  8.00 1.069 7.48 15.0            -0.5</span>
<span class="co">#&gt; 4 Kimberley  9.01 1.285 7.01 15.8            -0.5</span>
<span class="co">#&gt; 5  Samantha  6.50 0.685 9.50 15.4            -0.5</span>
<span class="co">#&gt;   distance_correction</span>
<span class="co">#&gt; 1                   0</span>
<span class="co">#&gt; 2                   0</span>
<span class="co">#&gt; 3                   0</span>
<span class="co">#&gt; 4                   0</span>
<span class="co">#&gt; 5                   0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;    0.0516    0.9994   -0.2188    0.1982    0.2188    0.0516 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;    0.0395       Inf</span></code></pre></div>
</div>
</div>
<div id="problems-at-the-start-when-using-split-times" class="section level2">
<h2 class="hasAnchor">
<a href="#problems-at-the-start-when-using-split-times" class="anchor"></a>Problems at the start when using split times</h2>
<p>Let’s imagine we have two twin brothers with same short sprint characteristics: MSS equal to 9<span class="math inline">\(ms^-1\)</span>, TAU equal to 1.3, and MAC equal to 6.92<span class="math inline">\(ms^-2\)</span>. Let’s call them John and Jack. They both perform 40m sprint using timing gates set at 5, 10, 20, 30, and 40m. The initial timing gate at the start (i.e., <span class="math inline">\(d=0m\)</span>) serves to activate the timing system (i.e., when they cross the beam).</p>
<p>John represents the <em>theoretical model</em>, in which we assume that the initial force production and the timing initiation are perfectly synchronized. Jack, on the other hand, represents a <em>practical model</em>, and decides to move slightly behind the initial timing gate (i.e. for 0.5m) and use body rocking to initiate the sprint start. In other words, Jack is using a <em>flying start</em>, a common scenario when testing field sports athletes. Let’s see how their sprint outcomes differ.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MSS</span> <span class="op">&lt;-</span> <span class="fl">9</span>
<span class="va">TAU</span> <span class="op">&lt;-</span> <span class="fl">1.3</span>
<span class="va">MAC</span> <span class="op">&lt;-</span> <span class="va">MSS</span> <span class="op">/</span> <span class="va">TAU</span>

<span class="va">split_times</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span><span class="op">)</span>,
  john_time <span class="op">=</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">MSS</span>, <span class="va">TAU</span><span class="op">)</span>,

  <span class="co"># Jack's performance</span>
  jack_distance <span class="op">=</span> <span class="va">distance</span> <span class="op">+</span> <span class="fl">0.5</span>,
  jack_true_time <span class="op">=</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span><span class="va">jack_distance</span>, <span class="va">MSS</span>, <span class="va">TAU</span><span class="op">)</span>,
  time_05m <span class="op">=</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">MSS</span>, <span class="va">TAU</span><span class="op">)</span>,
  jack_time <span class="op">=</span> <span class="va">jack_true_time</span> <span class="op">-</span> <span class="va">time_05m</span>
<span class="op">)</span>

<span class="va">split_times</span>
<span class="co">#&gt; # A tibble: 5 x 6</span>
<span class="co">#&gt;   distance john_time jack_distance jack_true_time time_05m</span>
<span class="co">#&gt;      &lt;dbl&gt;  &lt;I&lt;dbl&gt;&gt;         &lt;dbl&gt;       &lt;I&lt;dbl&gt;&gt; &lt;I&lt;dbl&gt;&gt;</span>
<span class="co">#&gt; 1        5      1.42           5.5           1.50    0.400</span>
<span class="co">#&gt; 2       10      2.17          10.5           2.23    0.400</span>
<span class="co">#&gt; 3       20      3.43          20.5           3.49    0.400</span>
<span class="co">#&gt; 4       30      4.60          30.5           4.65    0.400</span>
<span class="co">#&gt; 5       40      5.73          40.5           5.78    0.400</span>
<span class="co">#&gt; # … with 1 more variable: jack_time &lt;I&lt;dbl&gt;&gt;</span></code></pre></div>
<p>And here is a graphical representation of the sprint splits:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_df</span> <span class="op">&lt;-</span> <span class="va">split_times</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">distance</span>, <span class="va">john_time</span>, <span class="va">jack_time</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>John <span class="op">=</span> <span class="va">john_time</span>, Jack <span class="op">=</span> <span class="va">jack_time</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, names_to <span class="op">=</span> <span class="st">"athlete"</span>, values_to <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">distance</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">plot_df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">time</span>, color <span class="op">=</span> <span class="va">athlete</span>, group <span class="op">=</span> <span class="va">athlete</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Time (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-21-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Using the following code, we can see the differences in estimated MSS and TAU parameters:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Since this is a perfect simulation and stats::nls will complain</span>
<span class="co"># we need to add very small noise, or measurement error to the times</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1667</span><span class="op">)</span>
<span class="va">rand_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">split_times</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span>
<span class="va">split_times</span><span class="op">$</span><span class="va">john_time</span> <span class="op">&lt;-</span> <span class="va">split_times</span><span class="op">$</span><span class="va">john_time</span> <span class="op">+</span> <span class="va">rand_noise</span>
<span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span> <span class="op">&lt;-</span> <span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span> <span class="op">+</span> <span class="va">rand_noise</span>

<span class="va">john_profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">john_time</span>
<span class="op">)</span>

<span class="va">jack_profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span>
<span class="op">)</span>

<span class="va">sprint_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">john_profile</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sprint_parameters</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Jack"</span><span class="op">)</span>

<span class="va">sprint_parameters</span>
<span class="co">#&gt;       MSS   TAU   MAC PMAX time_correction</span>
<span class="co">#&gt; John 9.00 1.300  6.92 15.6               0</span>
<span class="co">#&gt; Jack 8.49 0.704 12.06 25.6               0</span>
<span class="co">#&gt;      distance_correction</span>
<span class="co">#&gt; John                   0</span>
<span class="co">#&gt; Jack                   0</span></code></pre></div>
<p>As can be seen from the results, a flying start yields biased estimates, particularly for the TAU, MAC and PMAX.</p>
<p>Below is a simulation sprint with 5, 10, 20, 30, 40, and 50m splits, with MSS and MAC varying from 6 to 9 (<span class="math inline">\(ms^-1\)</span> and <span class="math inline">\(ms^-2\)</span> respectively), and flying start distance varying from 0 to 1m.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>
  MSS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>,
  MAC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>,
  flying_start_distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
  <span class="op">)</span>,
  distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">sim_df</span> <span class="op">&lt;-</span> <span class="va">sim_df</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    TAU <span class="op">=</span> <span class="va">MSS</span> <span class="op">/</span> <span class="va">MAC</span>,
    PMAX <span class="op">=</span> <span class="va">MSS</span> <span class="op">*</span> <span class="va">MAC</span> <span class="op">/</span> <span class="fl">4</span>,
    true_distance <span class="op">=</span> <span class="va">distance</span> <span class="op">+</span> <span class="va">flying_start_distance</span>,
    true_time <span class="op">=</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span><span class="va">true_distance</span>, <span class="va">MSS</span>, <span class="va">TAU</span><span class="op">)</span>,
    stolen_time <span class="op">=</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span><span class="va">flying_start_distance</span>, <span class="va">MSS</span>, <span class="va">TAU</span><span class="op">)</span>,
    time <span class="op">=</span> <span class="va">true_time</span> <span class="op">-</span> <span class="va">stolen_time</span>
  <span class="op">)</span>

<span class="co"># Add small noise to allow model fit</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1667</span><span class="op">)</span>
<span class="va">rand_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_df</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span>
<span class="va">sim_df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">sim_df</span><span class="op">$</span><span class="va">time</span> <span class="op">+</span> <span class="va">rand_noise</span></code></pre></div>
<p>Now when we have a simulation dataset, we can check the model estimates and predictions, given the flying start distance:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Prediction wrapper</span>
<span class="va">pred_wrapper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
    time <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">time</span>
  <span class="op">)</span>

  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

  <span class="va">predicted_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
    MSS <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">MSS</span>,
    TAU <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">TAU</span>
  <span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"est_MSS"</span>, <span class="st">"est_TAU"</span>, <span class="st">"est_MAC"</span>, <span class="st">"est_PMAX"</span>,
    <span class="st">"est_time_correction"</span>, <span class="st">"est_distance_correction"</span>
  <span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
    <span class="va">data</span>,
    <span class="va">params</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>predicted_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">predicted_time</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="co"># estimated parameters and predicted time</span>
<span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">sim_df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">MSS</span>, <span class="va">TAU</span>, <span class="va">flying_start_distance</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do</span><span class="op">(</span><span class="fu">pred_wrapper</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span>

<span class="co"># Prediction residuals</span>
<span class="va">model_df</span><span class="op">$</span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="va">model_df</span><span class="op">$</span><span class="va">predicted_time</span> <span class="op">-</span> <span class="va">model_df</span><span class="op">$</span><span class="va">time</span></code></pre></div>
<p>The following image demonstrates the effect of flying start distance on estimated MSS:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimates plot</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">model_df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">MSS</span>, <span class="va">TAU</span>, <span class="va">flying_start_distance</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    MSS_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MSS ="</span>, <span class="va">MSS</span><span class="op">)</span>,
    TAU_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU ="</span>, <span class="va">TAU</span><span class="op">)</span>,
    MAC_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MAC = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">MAC</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    PMAX_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PMAX = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMAX</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># MSS</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_MSS</span>, color <span class="op">=</span> <span class="va">MAC_string</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated MSS (m/s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>As can be seen from the image, MSS is underestimated as flying start distance increases. The following image demonstrates the effect of flying start distance on estimated MAC:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MAC</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_MAC</span>, color <span class="op">=</span> <span class="va">MSS_string</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">MAC_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated MAC (m/s/s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>MAC (and also TAU) are highly affected by the flying start distance, and from the figure we can notice that MAC is overestimated as flying start distance increases.</p>
<p>And finally, the following image demonstrates the effect of flying start distance on estimated PMAX:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># PMAX</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_PMAX</span>, color <span class="op">=</span> <span class="va">MSS_string</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">MAC_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated PMAX (W/kg)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Estimated PMAX is also overestimated as flying start distance increases.</p>
<p>Model residuals are also affected by flying start distance. The shape of residuals distribution depends on number and splits utilized (e.g., 10, 20, 30, 40m versus 5, 15, 30m), but here we can see the effect of the flying start distance on the model residuals per split distance utilized in our simulation:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Residuals</span>
<span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">model_df</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    MSS_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MSS ="</span>, <span class="va">MSS</span><span class="op">)</span>,
    TAU_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU ="</span>, <span class="va">TAU</span><span class="op">)</span>,
    MAC_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MAC = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">MAC</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    PMAX_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PMAX = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMAX</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">MSS</span>, <span class="va">MAC</span>, <span class="va">flying_start_distance</span><span class="op">)</span>
  <span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">model_df</span>,
  <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">residuals</span>, x <span class="op">=</span> <span class="va">distance</span>, color <span class="op">=</span> <span class="va">flying_start_distance</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MSS_string</span> <span class="op">~</span> <span class="va">MAC_string</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_gradientn</span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">5</span>, rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Predicted time - observed time (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Flying start distance"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>If we merge individual facets (i.e., combinations of MSS and MAC), we can get simpler images conveying issues with residuals when there is a flying start:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">model_df</span>,
  <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">residuals</span>, x <span class="op">=</span> <span class="va">distance</span>, color <span class="op">=</span> <span class="va">flying_start_distance</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_gradientn</span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">5</span>, rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Predicted time - observed time (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Flying start distance"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Clearly, any type of flying start where there is a difference between initial force production and start time can result in biased parameters and predictions. Since maximal sprint speed is difficult to improve, the effects of start inconsistencies can mask effects of the training intervention. It is thus crucial to standardize the start when testing and implementing the following techniques when using the <strong>shorts</strong> package.</p>
<div id="how-to-overcome-missing-the-initial-force-production-when-using-timing-gates" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-overcome-missing-the-initial-force-production-when-using-timing-gates" class="anchor"></a>How to overcome missing the initial force production when using timing gates?</h3>
<p>A potential solution is to use a correction factor - the recommendation in the literature is +0.5sec <span class="citation">(Thomas A. Haugen, Breitschädel, and Seiler <a href="#ref-haugenSprintMechanicalProperties2020" role="doc-biblioref">2020</a>; Haugen, Breitschädel, and Seiler <a href="#ref-haugenSprintMechanicalVariables2019" role="doc-biblioref">2019</a>)</span>. Interestingly, the average difference between using timing gates and a block start for 40 m sprint time was 0.27 sec <span class="citation">(Haugen, Tønnessen, and Seiler <a href="#ref-haugenDifferenceStartImpact2012" role="doc-biblioref">2012</a>)</span>. So, while a timing correction factor is warranted to avoid subsequent errors in estimates of kinetic variables (e.g., overestimate power), a correction factor that is too large will have the opposite effect (e.g., underestimate power).</p>
<p>When implementing <em>time correction</em>, equation @ref(eq:time-distance) becomes:</p>
<p><span class="math display">\[\begin{equation}
  t(d) = TAU \times W(-e^{\frac{-d}{MSS \times TAU}} - 1) + \frac{d}{MSS} + TAU - time \; correction (\#eq:time-correction)
\end{equation}\]</span></p>
<p>Rather than providing <em>apriori</em> time correction from the literature, <strong>shorts</strong> package provides an estimation of this parameter from the data provided, together with MSS and TAU. To estimate time correction, we use <code>model_using_splits_with_time_correction</code> function. Here is how we can estimate Jack parameters using either provided time correction (e.g., +0.3 and +0.5s) or estimated time correction:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jack_profile_fixed_time_short</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span>,
  time_correction <span class="op">=</span> <span class="fl">0.3</span>
<span class="op">)</span>

<span class="va">jack_profile_fixed_time_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span>,
  time_correction <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>

<span class="va">jack_profile_time_estimated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_time_correction</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span>
<span class="op">)</span>

<span class="va">jack_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">john_profile</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile_fixed_time_short</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile_fixed_time_long</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile_time_estimated</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">jack_parameters</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"John"</span>,
  <span class="st">"Jack - No corrections"</span>,
  <span class="st">"Jack - Fixed time correction (+0.3s)"</span>,
  <span class="st">"Jack - Fixed time correction (+0.5s)"</span>,
  <span class="st">"Jack - Estimated time correction"</span>
<span class="op">)</span>

<span class="va">jack_parameters</span>
<span class="co">#&gt;                                       MSS   TAU   MAC PMAX</span>
<span class="co">#&gt; John                                 9.00 1.300  6.92 15.6</span>
<span class="co">#&gt; Jack - No corrections                8.49 0.704 12.06 25.6</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.3s) 9.00 1.251  7.19 16.2</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.5s) 9.62 1.770  5.43 13.1</span>
<span class="co">#&gt; Jack - Estimated time correction     8.96 1.216  7.37 16.5</span>
<span class="co">#&gt;                                      time_correction</span>
<span class="co">#&gt; John                                           0.000</span>
<span class="co">#&gt; Jack - No corrections                          0.000</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.3s)           0.300</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.5s)           0.500</span>
<span class="co">#&gt; Jack - Estimated time correction               0.284</span>
<span class="co">#&gt;                                      distance_correction</span>
<span class="co">#&gt; John                                                   0</span>
<span class="co">#&gt; Jack - No corrections                                  0</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.3s)                   0</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.5s)                   0</span>
<span class="co">#&gt; Jack - Estimated time correction                       0</span></code></pre></div>
<p>In Jack’s case, both +0.3s fixed time correction and time correction estimation yield parameters closer to John’s (i.e. true parameters).</p>
<p>Another model definition, which is a novel approach implemented in the <strong>shorts</strong> packages, is to utilize <em>distance correction</em>, besides time correction. Thus, equation @ref(eq:time-distance) becomes:</p>
<p><span class="math display">\[\begin{equation}
  t(d) = TAU \times W(-e^{\frac{-d + distance \; correction}{MSS \times TAU}} - 1) + \frac{d + distance \; correction}{MSS} + TAU - time \; correction (\#eq:distance-correction)
\end{equation}\]</span></p>
<p>This model is implemented in <code>model_using_splits_with_corrections</code> function. Below are the model estimates:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jack_profile_distance_correction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_corrections</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span>
<span class="op">)</span>

<span class="va">jack_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">john_profile</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile_fixed_time_short</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile_fixed_time_long</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile_time_estimated</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">jack_profile_distance_correction</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">jack_parameters</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"John"</span>,
  <span class="st">"Jack - No corrections"</span>,
  <span class="st">"Jack - Fixed time correction (+0.3s)"</span>,
  <span class="st">"Jack - Fixed time correction (+0.5s)"</span>,
  <span class="st">"Jack - Estimated time correction"</span>,
  <span class="st">"Jack - Estimated distance correction"</span>
<span class="op">)</span>

<span class="va">jack_parameters</span>
<span class="co">#&gt;                                       MSS   TAU   MAC PMAX</span>
<span class="co">#&gt; John                                 9.00 1.300  6.92 15.6</span>
<span class="co">#&gt; Jack - No corrections                8.49 0.704 12.06 25.6</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.3s) 9.00 1.251  7.19 16.2</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.5s) 9.62 1.770  5.43 13.1</span>
<span class="co">#&gt; Jack - Estimated time correction     8.96 1.216  7.37 16.5</span>
<span class="co">#&gt; Jack - Estimated distance correction 9.00 1.301  6.92 15.6</span>
<span class="co">#&gt;                                      time_correction</span>
<span class="co">#&gt; John                                           0.000</span>
<span class="co">#&gt; Jack - No corrections                          0.000</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.3s)           0.300</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.5s)           0.500</span>
<span class="co">#&gt; Jack - Estimated time correction               0.284</span>
<span class="co">#&gt; Jack - Estimated distance correction           0.400</span>
<span class="co">#&gt;                                      distance_correction</span>
<span class="co">#&gt; John                                               0.000</span>
<span class="co">#&gt; Jack - No corrections                              0.000</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.3s)               0.000</span>
<span class="co">#&gt; Jack - Fixed time correction (+0.5s)               0.000</span>
<span class="co">#&gt; Jack - Estimated time correction                   0.000</span>
<span class="co">#&gt; Jack - Estimated distance correction               0.503</span></code></pre></div>
<p>As can be seen from the results, adding distance correction results in correctly estimating Jack’s sprint parameters. There are a few issues with this model definition. Besides being novel and still not validated with actual data, distance correction model has four parameters to estimate, which implies that at least five sprint splits are needed. This imposes practical limitations, since acquiring six timing gate (one for the start and five for splits) might be practically troublesome.</p>
<p>We will get back to these issues later, but we can examine how these models perform using simulated data with varying flying start distance. The following code contains the wrapper that performs all four models (no correction, fixed time correction, estimated time correction, and estimated time and distance correction):</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred_wrapper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">no_correction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
    time <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">time</span>
  <span class="op">)</span>

  <span class="va">fixed_correction_short</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
    time <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">time</span>,
    time_correction <span class="op">=</span> <span class="fl">0.3</span>
  <span class="op">)</span>

  <span class="va">fixed_correction_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
    time <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">time</span>,
    time_correction <span class="op">=</span> <span class="fl">0.5</span>
  <span class="op">)</span>

  <span class="va">time_correction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_time_correction</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
    time <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">time</span>,
    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.control.html">nls.control</a></span><span class="op">(</span>tol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">time_dist_correction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_corrections</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
    time <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">time</span>,
    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.control.html">nls.control</a></span><span class="op">(</span>tol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span>


  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      model <span class="op">=</span> <span class="st">"No correction"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">no_correction</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      model <span class="op">=</span> <span class="st">"Fixed correction +0.3s"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">fixed_correction_short</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      model <span class="op">=</span> <span class="st">"Fixed correction +0.5s"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">fixed_correction_long</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      model <span class="op">=</span> <span class="st">"Time correction"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">time_correction</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      model <span class="op">=</span> <span class="st">"Time and distance correction"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">time_dist_correction</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"model"</span>, <span class="st">"est_MSS"</span>, <span class="st">"est_TAU"</span>, <span class="st">"est_MAC"</span>, <span class="st">"est_PMAX"</span>,
    <span class="st">"est_time_correction"</span>, <span class="st">"est_distance_correction"</span>
  <span class="op">)</span>

  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span>
    <span class="va">data</span>,
    <span class="va">params</span>
  <span class="op">)</span>

  <span class="va">df</span><span class="op">$</span><span class="va">predicted_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span>
    distance <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">distance</span>,
    MSS <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">est_MSS</span>,
    TAU <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">est_TAU</span>,
    time_correction <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">est_time_correction</span>,
    distance_correction <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">est_distance_correction</span>
  <span class="op">)</span>

  <span class="va">df</span><span class="op">$</span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">predicted_time</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># estimated parameters and predicted time</span>
<span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">sim_df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">MSS</span>, <span class="va">TAU</span>, <span class="va">flying_start_distance</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do</span><span class="op">(</span><span class="fu">pred_wrapper</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>As can be seen from the next figure, the estimated time correction model estimates MSS almost perfectly, while the estimated time and distance correction model estimates MSS perfectly.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_df</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">model_df</span><span class="op">$</span><span class="va">model</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"No correction"</span>,
    <span class="st">"Fixed correction +0.3s"</span>,
    <span class="st">"Fixed correction +0.5s"</span>,
    <span class="st">"Time correction"</span>,
    <span class="st">"Time and distance correction"</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co"># Estimates plot</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">model_df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">MSS</span>, <span class="va">TAU</span>, <span class="va">flying_start_distance</span>, <span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    MSS_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MSS ="</span>, <span class="va">MSS</span><span class="op">)</span>,
    TAU_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU ="</span>, <span class="va">TAU</span><span class="op">)</span>,
    MAC_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MAC = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">MAC</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    PMAX_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PMAX = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMAX</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># MSS</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_MSS</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MSS_string</span> <span class="op">~</span> <span class="va">MAC_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated MSS (m/s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-33-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Similar outcomes are observed for the MAC parameter. The time and distance corrections model performs perfectly, while the time correction model performs almost as good.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MAC</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_MAC</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MAC_string</span> <span class="op">~</span> <span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated MAC (m/s/s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-34-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>PMAX demonstrates the same properties as MSS and MAC.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># PMAX</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_PMAX</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MAC_string</span> <span class="op">~</span> <span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated PMAX (W/kg)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-35-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following figure depicts estimated time correction, and as can be seen, only the time and distance correction model estimated the time correction correctly (i.e., the <em>stolen time</em>; indicated by the dashed line on the figure).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># time_correction</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_time_correction</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">stolen_time</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MAC_string</span> <span class="op">~</span> <span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated time correction (s)"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following figure depicts estimated distance correction, and same as with the time correction, only the time and distance correction model estimated the distance correction correctly (i.e., flying start distance; indicated by the dashed line on the figure, which represents <em>identity line</em> since flying start distance is already on the x-axis).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># distance_correction</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flying_start_distance</span>, y <span class="op">=</span> <span class="va">est_distance_correction</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MAC_string</span> <span class="op">~</span> <span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Flying start distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated distance correction (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-37-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following figure depicts model residuals against the distance, and as can be seen, time correction and time and distance correction models performs much better than no correction and fixed correction models:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Residuals</span>
<span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">model_df</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    MSS_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MSS ="</span>, <span class="va">MSS</span><span class="op">)</span>,
    TAU_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU ="</span>, <span class="va">TAU</span><span class="op">)</span>,
    MAC_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MAC = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">MAC</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    PMAX_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PMAX = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMAX</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">MSS</span>, <span class="va">MAC</span>, <span class="va">flying_start_distance</span><span class="op">)</span>
  <span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">model_df</span>,
  <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">residuals</span>, x <span class="op">=</span> <span class="va">distance</span>, color <span class="op">=</span> <span class="va">flying_start_distance</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">model</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_gradientn</span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">5</span>, rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Predicted time - observed time (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Flying start distance"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-38-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The outcomes from the simulation data clearly demonstrates that the time correction and time and distance correction models represent sound improvements in parameter estimation and model fit compared to no corrections model and fixed correction model when attempting to overcome the flying start issues. Since the time correction model is simpler and requires three parameters to be estimated, it might be practically more useful than the time and distance correction model, which requires four parameters estimation and thus more than five timing gates and sprint splits.</p>
<p>Time correction and time and distance corrections are also implemented in the mixed-models using <code>mixed_model_using_splits_with_time_correction</code> and <code>mixed_model_using_splits_with_corrections</code>. We will showcase their use at the end of this article.</p>
</div>
<div id="simulation-of-additional-starting-issues" class="section level3">
<h3 class="hasAnchor">
<a href="#simulation-of-additional-starting-issues" class="anchor"></a>Simulation of additional starting issues</h3>
<p>Starting behind the initial timing gate represent only one issue (i.e. flying start). In this section, we simulate one more issue to check the sensitivity of the presented models to other (less common) perturbations when performing field testing.</p>
<p>One issue that might happen with timing gates is triggering the timing system before the sprint is initiated (e.g., by cutting the beam with an arm swing prematurely). This is very similar to the situation when timing starts on a signal (i.e., gun during 100m sprint race) and there is <em>reaction time</em> (RT) involved. Both of these scenarios represent <em>time lag</em> that is added to the split times. Below we simulate the effect of this time lag on model estimates and predictions.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>
  MSS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>,
  MAC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>,
  time_lag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,
  distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">sim_df</span> <span class="op">&lt;-</span> <span class="va">sim_df</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    TAU <span class="op">=</span> <span class="va">MSS</span> <span class="op">/</span> <span class="va">MAC</span>,
    PMAX <span class="op">=</span> <span class="va">MSS</span> <span class="op">*</span> <span class="va">MAC</span> <span class="op">/</span> <span class="fl">4</span>,
    true_time <span class="op">=</span> <span class="fu"><a href="../reference/predict_kinematics.html">predict_time_at_distance</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">MSS</span>, <span class="va">TAU</span><span class="op">)</span>,
    time <span class="op">=</span> <span class="va">true_time</span> <span class="op">+</span> <span class="va">time_lag</span>
  <span class="op">)</span>

<span class="co"># Add small noise to allow model fit</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1667</span><span class="op">)</span>
<span class="va">rand_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_df</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span>
<span class="va">sim_df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">sim_df</span><span class="op">$</span><span class="va">time</span> <span class="op">+</span> <span class="va">rand_noise</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># estimated parameters and predicted time</span>
<span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">sim_df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">MSS</span>, <span class="va">TAU</span>, <span class="va">time_lag</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do</span><span class="op">(</span><span class="fu">pred_wrapper</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>From the figure below it can be seen that time lag affects estimated MSS for the the model without correction and fixed correction model. Time correction and time and distance corrections models correctly estimated MSS.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_df</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">model_df</span><span class="op">$</span><span class="va">model</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"No correction"</span>,
    <span class="st">"Fixed correction +0.3s"</span>,
    <span class="st">"Fixed correction +0.5s"</span>,
    <span class="st">"Time correction"</span>,
    <span class="st">"Time and distance correction"</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co"># Estimates plot</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">model_df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">MSS</span>, <span class="va">TAU</span>, <span class="va">time_lag</span>, <span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    MSS_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MSS ="</span>, <span class="va">MSS</span><span class="op">)</span>,
    TAU_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU ="</span>, <span class="va">TAU</span><span class="op">)</span>,
    MAC_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MAC = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">MAC</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    PMAX_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PMAX = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMAX</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># MSS</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_lag</span>, y <span class="op">=</span> <span class="va">est_MSS</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MSS_string</span> <span class="op">~</span> <span class="va">MAC_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Time lag (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated MSS (m/s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-41-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>From the figure below it can be seen that time lag affects estimated MAC for the the model without correction and fixed correction models. Time correction and time and distance corrections model correctly estimated MAC.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MAC</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_lag</span>, y <span class="op">=</span> <span class="va">est_MAC</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MAC_string</span> <span class="op">~</span> <span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Time lag (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated MAC (m/s/s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-42-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The figure below depicts correctly identified time lag (i.e. using time correction parameter) using time correction and time and distance corrections models.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># time_correction</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_lag</span>, y <span class="op">=</span> <span class="va">est_time_correction</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MAC_string</span> <span class="op">~</span> <span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Time lag (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated time correction (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The next figure depicts estimated distance correction for the time and distance correction model. The estimated distance correction parameters looks jumpy due to random noise that we have to added to allow model fit.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># distance_correction</span>
<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_lag</span>, y <span class="op">=</span> <span class="va">est_distance_correction</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">MAC_string</span> <span class="op">~</span> <span class="va">MSS_string</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Time lag (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"estimated distance correction (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following figure depicts residuals (i.e., predicted time minus observed time).</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Residuals</span>
<span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">model_df</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    MSS_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MSS ="</span>, <span class="va">MSS</span><span class="op">)</span>,
    TAU_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"TAU ="</span>, <span class="va">TAU</span><span class="op">)</span>,
    MAC_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MAC = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">MAC</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    PMAX_string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PMAX = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMAX</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">MSS</span>, <span class="va">MAC</span>, <span class="va">time_lag</span><span class="op">)</span>
  <span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>
  <span class="va">model_df</span>,
  <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">residuals</span>, x <span class="op">=</span> <span class="va">distance</span>, color <span class="op">=</span> <span class="va">time_lag</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">model</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_gradientn</span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">5</span>, rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Predicted time - observed time (s)"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Time lag"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-45-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>There are few other starting issues worth mentioning. For example, if the initial timing gate has a time delay (i.e., once triggered, there is a time delay before the timing starts). In this case, time lag is a negative number since it reduces the split times. Another common issue with timing gates in the practical field settings is the bad measurement of the distance and thus bad positions of the timing gates.</p>
<p>The number and distances of the timing gates can also affect the precision of the estimated sprint parameters <span class="citation">(Thomas A. Haugen, Breitschädel, and Samozino <a href="#ref-haugenPowerForceVelocityProfilingSprinting2020" role="doc-biblioref">2020</a>; Haugen, Tønnessen, and Seiler <a href="#ref-haugenDifferenceStartImpact2012" role="doc-biblioref">2012</a>)</span>.</p>
<p>In field testing, multiple starting issues can be present. For example, one might have a bad position of the initial gate, athlete might be moved back but also manage to trigger the gate before the start commence. More elaborate simulation is beyond the scope of the current paper.</p>
</div>
</div>
</div>
<div id="leave-one-out-cross-validation" class="section level1">
<h1 class="hasAnchor">
<a href="#leave-one-out-cross-validation" class="anchor"></a>Leave-one-out Cross-Validation</h1>
<p>To estimate parameter stability, model over-fitting, and performance on the unseen data, <strong>shorts</strong> model function comes with implemented <em>leave-one-out cross validation</em> (LOOCV) <span class="citation">(James et al. <a href="#ref-jamesIntroductionStatisticalLearning2017" role="doc-biblioref">2017</a>; Jovanović <a href="#ref-jovanovicBmbstatsBootstrapMagnitudebased2020" role="doc-biblioref">2020</a>; Kuhn and Johnson <a href="#ref-kuhnAppliedPredictiveModeling2018" role="doc-biblioref">2018</a>)</span>. LOOCV involves a simple, yet powerful procedure, of removing each observation, rebuilding the model, and making predictions for that removed observation. This process is repeated for each observations in the model dataset. LOOCV allows one to check estimated parameters stability, and model performance on the unseen data.</p>
<p>Let’s perform LOOCV using Jack’s data and the time correction model:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jack_LOOCV</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_time_correction</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">split_times</span><span class="op">$</span><span class="va">jack_time</span>,
  LOOCV <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="va">jack_LOOCV</span>
<span class="co">#&gt; Estimated model parameters</span>
<span class="co">#&gt; --------------------------</span>
<span class="co">#&gt;                 MSS                 TAU                 MAC </span>
<span class="co">#&gt;               8.958               1.216               7.367 </span>
<span class="co">#&gt;                PMAX     time_correction distance_correction </span>
<span class="co">#&gt;              16.499               0.284               0.000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit estimators</span>
<span class="co">#&gt; --------------------</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;   0.00181   1.00000  -0.00109   0.00189   0.00189   0.00114 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;   0.00104   0.04981 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Leave-One-Out Cross-Validation</span>
<span class="co">#&gt; ------------------------------</span>
<span class="co">#&gt; Parameters:</span>
<span class="co">#&gt;    MSS  TAU  MAC PMAX time_correction distance_correction</span>
<span class="co">#&gt; 1 8.98 1.25 7.21 16.2           0.300                   0</span>
<span class="co">#&gt; 2 8.97 1.22 7.35 16.5           0.284                   0</span>
<span class="co">#&gt; 3 8.95 1.21 7.40 16.5           0.282                   0</span>
<span class="co">#&gt; 4 8.96 1.21 7.39 16.5           0.282                   0</span>
<span class="co">#&gt; 5 8.93 1.20 7.45 16.6           0.278                   0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model fit:</span>
<span class="co">#&gt;       RSE R_squared    minErr    maxErr maxAbsErr      RMSE </span>
<span class="co">#&gt;        NA   1.00000  -0.00639   0.00510   0.00639   0.00401 </span>
<span class="co">#&gt;       MAE      MAPE </span>
<span class="co">#&gt;   0.00349   0.18387</span></code></pre></div>
<p>The model print output provides training dataset estimates and model performance, as well as LOOCV estimates and model performance.</p>
<p>Next we plot estimated parameters across LOOCV folds:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">jack_LOOCV</span><span class="op">$</span><span class="va">LOOCV</span><span class="op">$</span><span class="va">parameters</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">df</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, names_to <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">parameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">df</span><span class="op">$</span><span class="va">parameter</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"MSS"</span>,
    <span class="st">"TAU"</span>,
    <span class="st">"MAC"</span>,
    <span class="st">"PMAX"</span>,
    <span class="st">"time_correction"</span>,
    <span class="st">"distance_correction"</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    axis.ticks.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-47-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Here is the plot of the training and LOOCV residuals:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">jack_LOOCV</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">distance</span>,
  time <span class="op">=</span> <span class="va">jack_LOOCV</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">time</span>,
  pred_time <span class="op">=</span> <span class="va">jack_LOOCV</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">pred_time</span>,
  LOOCV_time <span class="op">=</span> <span class="va">jack_LOOCV</span><span class="op">$</span><span class="va">LOOCV</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">pred_time</span>
<span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pred_time"</span>, <span class="st">"LOOCV_time"</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">value</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">resid</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Distance (m)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Predicted - observed time (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-48-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>As expected, the model has more issues predicting unseen short or long sprints. Please note, that since LOOCV removes one observation, if the model estimates three parameters, then at least five observations are needed, since we need to make sure the model can be estimated once a single observation is removed. LOOCV can also be implemented with the mixed-effects models in the <strong>shorts</strong> package.</p>
</div>
<div id="example-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#example-analysis" class="anchor"></a>Example analysis</h1>
<p>Let’s utilize demonstrated functionalities of the <strong>shorts</strong> package using real-world data. The first dataset comes from Usain Bolt’s performance from IAAF World Championship held in London, 2017, and the second dataset involve Jason Vescovi’s sample data for 52 female soccer and field hockey athletes which comes with the <strong>shorts</strong> package (see <code><a href="../reference/vescovi.html">?vescovi</a></code>).</p>
<div id="usain-bolts-run-from-london-2017" class="section level2">
<h2 class="hasAnchor">
<a href="#usain-bolts-run-from-london-2017" class="anchor"></a>Usain Bolt’s run from London 2017</h2>
<p>The following dataset represents Usain Bolt’s race in the finals at the IAAF World Championship held in London, 2017. Since reaction time enters the splits, we want to see how that will affect the model estimates, and particularly, if the estimated time correction model will pick-up reaction time.</p>
<p>For the sake of this analysis, only 10m splits over 60m are used.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bolt_reaction_time</span> <span class="op">&lt;-</span> <span class="fl">0.183</span>

<span class="va">bolt_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span><span class="op">)</span>
<span class="va">bolt_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.963</span>, <span class="fl">2.983</span>, <span class="fl">3.883</span>, <span class="fl">4.763</span>, <span class="fl">5.643</span>, <span class="fl">6.493</span><span class="op">)</span>

<span class="co"># No corrections model</span>
<span class="va">bolt_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">bolt_distance</span>,
  time <span class="op">=</span> <span class="va">bolt_time</span>
<span class="op">)</span>

<span class="co"># Model with reaction time as fixed time correction</span>
<span class="va">bolt_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">bolt_distance</span>,
  time <span class="op">=</span> <span class="va">bolt_time</span>,
  time_correction <span class="op">=</span> <span class="op">-</span><span class="va">bolt_reaction_time</span>
<span class="op">)</span>

<span class="co"># Model with estimated time correction</span>
<span class="va">bolt_m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_time_correction</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">bolt_distance</span>,
  time <span class="op">=</span> <span class="va">bolt_time</span>
<span class="op">)</span>

<span class="co"># Model with estimated time correction, but deducted reaction time</span>
<span class="va">bolt_m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_time_correction</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">bolt_distance</span>,
  time <span class="op">=</span> <span class="va">bolt_time</span> <span class="op">-</span> <span class="va">bolt_reaction_time</span>
<span class="op">)</span>

<span class="co"># Model with estimated time and distance corrections</span>
<span class="va">bolt_m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_corrections</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">bolt_distance</span>,
  time <span class="op">=</span> <span class="va">bolt_time</span>
<span class="op">)</span>

<span class="co"># Model with estimated time and distance corrections and deducted reaction time</span>
<span class="va">bolt_m6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_split_times.html">model_using_splits_with_corrections</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">bolt_distance</span>,
  time <span class="op">=</span> <span class="va">bolt_time</span> <span class="op">-</span> <span class="va">bolt_reaction_time</span>
<span class="op">)</span>

<span class="va">bolt_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"No correction"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bolt_m1</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"No correction - RT"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bolt_m2</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bolt_m3</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction - RT"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bolt_m4</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Distance correction"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bolt_m5</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Distance correction - RT"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bolt_m6</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">bolt_model</span>
<span class="co">#&gt;                      model  MSS   TAU   MAC PMAX</span>
<span class="co">#&gt; 1            No correction 12.1 1.564  7.77 23.6</span>
<span class="co">#&gt; 2       No correction - RT 11.7 1.205  9.74 28.6</span>
<span class="co">#&gt; 3          Time correction 11.7 1.202  9.76 28.6</span>
<span class="co">#&gt; 4     Time correction - RT 11.7 1.202  9.76 28.6</span>
<span class="co">#&gt; 5      Distance correction 11.6 0.855 13.56 39.3</span>
<span class="co">#&gt; 6 Distance correction - RT 11.6 0.855 13.56 39.3</span>
<span class="co">#&gt;   time_correction distance_correction</span>
<span class="co">#&gt; 1         0.00000                0.00</span>
<span class="co">#&gt; 2        -0.18300                0.00</span>
<span class="co">#&gt; 3        -0.18483                0.00</span>
<span class="co">#&gt; 4        -0.00183                0.00</span>
<span class="co">#&gt; 5        -0.81151               -3.98</span>
<span class="co">#&gt; 6        -0.62851               -3.98</span></code></pre></div>
<p>Here is the model estimate of the time and distance it takes for Bolt to reach 99% of MSS. Please note that we are not using distance and time correction parameters, since we want these estimates to be on the time/distance scale aligned with the actual sprint start, not the measurement scale.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bolt_model</span> <span class="op">&lt;-</span> <span class="va">bolt_model</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    dist_99_MSS <span class="op">=</span> <span class="fu"><a href="../reference/find_functions.html">find_velocity_critical_distance</a></span><span class="op">(</span>
      MSS <span class="op">=</span> <span class="va">MSS</span>, TAU <span class="op">=</span> <span class="va">TAU</span>, 
      <span class="co">#time_correction = time_correction, </span>
      <span class="co">#distance_correction = distance_correction,</span>
      percent <span class="op">=</span> <span class="fl">0.99</span>
    <span class="op">)</span>,
   time_99_MSS <span class="op">=</span> <span class="fu"><a href="../reference/find_functions.html">find_velocity_critical_time</a></span><span class="op">(</span>
      MSS <span class="op">=</span> <span class="va">MSS</span>, TAU <span class="op">=</span> <span class="va">TAU</span>, 
      <span class="co">#time_correction = time_correction, </span>
      percent <span class="op">=</span> <span class="fl">0.99</span>
    <span class="op">)</span>
  <span class="op">)</span>

<span class="va">bolt_model</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt; # Groups:   model [6]</span>
<span class="co">#&gt;   model                    dist_99_MSS time_99_MSS</span>
<span class="co">#&gt;   &lt;chr&gt;                          &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 No correction                   68.7        7.20</span>
<span class="co">#&gt; 2 No correction - RT              51.1        5.55</span>
<span class="co">#&gt; 3 Time correction                 51.0        5.54</span>
<span class="co">#&gt; 4 Time correction - RT            51.0        5.54</span>
<span class="co">#&gt; 5 Distance correction             35.8        3.94</span>
<span class="co">#&gt; 6 Distance correction - RT        35.8        3.94</span></code></pre></div>
</div>
<div id="vescovi-data" class="section level2">
<h2 class="hasAnchor">
<a href="#vescovi-data" class="anchor"></a>Vescovi data</h2>
<p>The data from Vescovi represents a sub-set of data from a total of 220 high-level female athletes (151 soccer players and 69 field hockey players). Using a random number generator, a total of 52 players (35 soccer and 17 field hockey) were selected for the sample dataset.</p>
<p>The protocol for assessing linear sprint speed has been described previously <span class="citation">(Vescovi <a href="#ref-vescoviImpactMaximumSpeed2014" role="doc-biblioref">2014</a>, <a href="#ref-vescoviLocomotorHeartRateMetabolic2016" role="doc-biblioref">2016</a>, <a href="#ref-vescoviSprintSpeedCharacteristics2012" role="doc-biblioref">2012</a>)</span> and was identical for each cohort. Briefly, all athletes performed a standardized warm-up that included general exercises such as jogging, shuffling, multi-directional movements, and dynamic stretching exercises. Infrared timing gates (Brower Timing, Utah) were positioned at the start line and at 5, 10, 20, 30, and 35 meters at a height of approximately 1.0 meter. Participants stood with their lead foot positioned approximately 5 cm behind the initial infrared beam (i.e., start line). Only forward movement was permitted (no leaning or rocking backwards) and timing started when the laser of the starting gate was triggered. The best 35 m time, and all associated split times were kept for analysis.</p>
<p>Below is the mixed-effects models analysis of the dataset.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"vescovi"</span><span class="op">)</span>

<span class="co"># Convert data to long</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">vescovi</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># slice(1:10) %&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">13</span>,
    names_to <span class="op">=</span> <span class="st">"distance"</span>,
    values_to <span class="op">=</span> <span class="st">"time"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">str_extract</span><span class="op">(</span><span class="va">distance</span>, <span class="st">"^[0-9]+"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>The following models were used: (1) no corrections model, (2) fixed time correction model (using 0.3s heuristic rule of thumb), (3) estimated time correction as a fixed effect model, (4) estimated time correction as a random effect model, (5) estimated distance correction as fixed effect model (and time correction as random effect), and (6) estimated distance correction as random effect model.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">no_corrections</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_split_times.html">mixed_model_using_splits</a></span><span class="op">(</span>
  <span class="va">df</span>,
  distance <span class="op">=</span> <span class="st">"distance"</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  athlete <span class="op">=</span> <span class="st">"Athlete"</span>
<span class="op">)</span>

<span class="va">fixed_correction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_split_times.html">mixed_model_using_splits</a></span><span class="op">(</span>
  <span class="va">df</span>,
  distance <span class="op">=</span> <span class="st">"distance"</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  athlete <span class="op">=</span> <span class="st">"Athlete"</span>,
  time_correction <span class="op">=</span> <span class="fl">0.3</span>
<span class="op">)</span>

<span class="va">time_correction_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_split_times.html">mixed_model_using_splits_with_time_correction</a></span><span class="op">(</span>
  <span class="va">df</span>,
  distance <span class="op">=</span> <span class="st">"distance"</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  athlete <span class="op">=</span> <span class="st">"Athlete"</span>,
  random <span class="op">=</span> <span class="va">MSS</span> <span class="op">+</span> <span class="va">TAU</span> <span class="op">~</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="va">time_correction_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_split_times.html">mixed_model_using_splits_with_time_correction</a></span><span class="op">(</span>
  <span class="va">df</span>,
  distance <span class="op">=</span> <span class="st">"distance"</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  athlete <span class="op">=</span> <span class="st">"Athlete"</span>,
  random <span class="op">=</span> <span class="va">MSS</span> <span class="op">+</span> <span class="va">TAU</span> <span class="op">+</span> <span class="va">time_correction</span> <span class="op">~</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="va">time_distance_correction_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_split_times.html">mixed_model_using_splits_with_corrections</a></span><span class="op">(</span>
  <span class="va">df</span>,
  distance <span class="op">=</span> <span class="st">"distance"</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  athlete <span class="op">=</span> <span class="st">"Athlete"</span>,
  random <span class="op">=</span> <span class="va">MSS</span> <span class="op">+</span> <span class="va">TAU</span> <span class="op">+</span> <span class="va">time_correction</span> <span class="op">~</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="va">time_distance_correction_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixed_model_split_times.html">mixed_model_using_splits_with_corrections</a></span><span class="op">(</span>
  <span class="va">df</span>,
  distance <span class="op">=</span> <span class="st">"distance"</span>,
  time <span class="op">=</span> <span class="st">"time"</span>,
  athlete <span class="op">=</span> <span class="st">"Athlete"</span>,
  random <span class="op">=</span> <span class="va">MSS</span> <span class="op">+</span> <span class="va">TAU</span> <span class="op">+</span> <span class="va">time_correction</span> <span class="op">+</span> <span class="va">distance_correction</span> <span class="op">~</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
<p>The following image represents model fit estimator RSE for each model. As can be seen, RSE is reduced the more flexible the model.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"No corrections"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">no_corrections</span><span class="op">$</span><span class="va">model_fit</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Fixed correction +0.3s"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">fixed_correction</span><span class="op">$</span><span class="va">model_fit</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction fixed"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">time_correction_fixed</span><span class="op">$</span><span class="va">model_fit</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction random"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">time_correction_random</span><span class="op">$</span><span class="va">model_fit</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time and distance correction fixed"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">time_distance_correction_fixed</span><span class="op">$</span><span class="va">model_fit</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time and distance correction random"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">time_distance_correction_random</span><span class="op">$</span><span class="va">model_fit</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">model_fit</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">model_fit</span><span class="op">$</span><span class="va">model</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"No corrections"</span>,
    <span class="st">"Fixed correction +0.3s"</span>,
    <span class="st">"Time correction fixed"</span>,
    <span class="st">"Time correction random"</span>,
    <span class="st">"Time and distance correction fixed"</span>,
    <span class="st">"Time and distance correction random"</span>
  <span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">model_fit</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">RSE</span>, y <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"RSE (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-53-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following image depicts estimated parameters for each model:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"No corrections"</span>,
    <span class="va">no_corrections</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">random</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Fixed correction +0.3s"</span>,
    <span class="va">fixed_correction</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">random</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction fixed"</span>,
    <span class="va">time_correction_fixed</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">random</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction random"</span>,
    <span class="va">time_correction_random</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">random</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time and distance correction fixed"</span>,
    <span class="va">time_distance_correction_fixed</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">random</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time and distance correction random"</span>,
    <span class="va">time_distance_correction_random</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">random</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">est_params</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">est_params</span><span class="op">$</span><span class="va">model</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"No corrections"</span>,
    <span class="st">"Fixed correction +0.3s"</span>,
    <span class="st">"Time correction fixed"</span>,
    <span class="st">"Time correction random"</span>,
    <span class="st">"Time and distance correction fixed"</span>,
    <span class="st">"Time and distance correction random"</span>
  <span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">est_params</span> <span class="op">&lt;-</span> <span class="va">est_params</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span>

<span class="va">est_params</span><span class="op">$</span><span class="va">parameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">est_params</span><span class="op">$</span><span class="va">parameter</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"MSS"</span>,
    <span class="st">"TAU"</span>,
    <span class="st">"MAC"</span>,
    <span class="st">"PMAX"</span>,
    <span class="st">"time_correction"</span>,
    <span class="st">"distance_correction"</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">est_params</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">model</span>, x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-54-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following image depicts model residuals across distance splits. To provide practical magnitude of the residuals, we have used between subject observed time SD multiplied with 0.2 and -0.2. This provides practical anchor for the residual magnitude, often referred to as <em>smallest worthwhile change</em> (SWC) or <em>smallest effect size of interest</em> (SESOI) <span class="citation">(Jovanović <a href="#ref-jovanovicBmbstatsBootstrapMagnitudebased2020" role="doc-biblioref">2020</a>)</span>. If the residuals are within this magnitude band, then the model is good in making practically useful predictions.</p>
<p>Error bars represent residual bias <span class="math inline">\(\pm\)</span> 1SD.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"No corrections"</span>,
    <span class="va">no_corrections</span><span class="op">$</span><span class="va">data</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Fixed correction +0.3s"</span>,
    <span class="va">fixed_correction</span><span class="op">$</span><span class="va">data</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction fixed"</span>,
    <span class="va">time_correction_fixed</span><span class="op">$</span><span class="va">data</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time correction random"</span>,
    <span class="va">time_correction_random</span><span class="op">$</span><span class="va">data</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time and distance correction fixed"</span>,
    <span class="va">time_distance_correction_fixed</span><span class="op">$</span><span class="va">data</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="st">"Time and distance correction random"</span>,
    <span class="va">time_distance_correction_random</span><span class="op">$</span><span class="va">data</span>
  <span class="op">)</span>
<span class="op">)</span>


<span class="va">model_resid</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">model_resid</span><span class="op">$</span><span class="va">model</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"No corrections"</span>,
    <span class="st">"Fixed correction +0.3s"</span>,
    <span class="st">"Time correction fixed"</span>,
    <span class="st">"Time correction random"</span>,
    <span class="st">"Time and distance correction fixed"</span>,
    <span class="st">"Time and distance correction random"</span>
  <span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">model_resid</span><span class="op">$</span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">model_resid</span><span class="op">$</span><span class="va">pred_time</span> <span class="op">-</span> <span class="va">model_resid</span><span class="op">$</span><span class="va">time</span>

<span class="co"># Create SWC / SESOI band</span>
<span class="va">model_SESOI</span> <span class="op">&lt;-</span> <span class="va">model_resid</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">model</span>, <span class="va">distance</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>
    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span>,
    variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span>,
    upper <span class="op">=</span> <span class="va">bias</span> <span class="op">+</span> <span class="va">variance</span>,
    lower <span class="op">=</span> <span class="va">bias</span> <span class="op">-</span> <span class="va">variance</span>,
    MAD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">)</span>,
    SESOI_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.2</span>,
    SESOI_lower <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.2</span>
  <span class="op">)</span>

<span class="co"># Plot</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">model_resid</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">model_SESOI</span>,
    <span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">SESOI_lower</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">model_SESOI</span>,
    <span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">SESOI_upper</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">resid</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbarh</span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">model_SESOI</span>,
    <span class="fu">aes</span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">lower</span>, xmax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>,
    height <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">model_SESOI</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bias</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">distance</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Predicted time - observed time (s)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-55-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The following figure depicts model residuals estimators (bias, or mean residual; variance, or SD of the residuals, and MAD, or mean absolute difference).</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">model_SESOI</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"estimator"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">estimator</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bias"</span>, <span class="st">"variance"</span>, <span class="st">"MAD"</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">df</span><span class="op">$</span><span class="va">model</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"No corrections"</span>,
    <span class="st">"Fixed correction +0.3s"</span>,
    <span class="st">"Time correction fixed"</span>,
    <span class="st">"Time correction random"</span>,
    <span class="st">"Time and distance correction fixed"</span>,
    <span class="st">"Time and distance correction random"</span>
  <span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">estimator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">df</span><span class="op">$</span><span class="va">estimator</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bias"</span>, <span class="st">"variance"</span>, <span class="st">"MAD"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="va">estimator</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="shorts_files/figure-html/unnamed-chunk-56-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Which model should should be used? Although providing a better fit (using RSE as an estimator of model fit), the time and distance correction models often estimate these parameters that are harder to interpret (e.g., negative distance correction). Although providing novel theoretical models in this paper, we acknowledge the need for validating them in practice, against gold-standard methods, assessing their agreement, as well as their power in detecting and adjusting for timing inconsistencies.</p>
<p>We are hoping that the <strong>shorts</strong> package will help fellow sports scientists and coaches in exploring short sprint profiles and help in driving research, particularly in devising measuring protocols that are sensitive enough to capture training intervention changes, but also robust enough to take into account potential sprint initiation and timing inconsistencies.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-arsacModelingEnergetics100m2002">
<p>Arsac, Laurent M., and Elio Locatelli. 2002. “Modeling the Energetics of 100-M Running by Using Speed Curves of World Champions.” <em>Journal of Applied Physiology</em> 92 (5): 1781–8. <a href="https://doi.org/10.1152/japplphysiol.00754.2001">https://doi.org/10.1152/japplphysiol.00754.2001</a>.</p>
</div>
<div id="ref-brownAssessmentLinearSprinting2004">
<p>Brown, Todd D., Jason D. Vescovi, and Jaci L. Vanheest. 2004. “Assessment of Linear Sprinting Performance: A Theoretical Paradigm.” <em>Journal of Sports Science &amp; Medicine</em> 3 (4): 203–10.</p>
</div>
<div id="ref-buchheitMechanicalDeterminantsAcceleration2014">
<p>Buchheit, Martin, Pierre Samozino, Jonathan Alexander Glynn, Ben Simpson Michael, Hani Al Haddad, Alberto Mendez-Villanueva, and Jean Benoit Morin. 2014. “Mechanical Determinants of Acceleration and Maximal Sprinting Speed in Highly Trained Young Soccer Players.” <em>Journal of Sports Sciences</em> 32 (20): 1906–13. <a href="https://doi.org/10.1080/02640414.2014.965191">https://doi.org/10.1080/02640414.2014.965191</a>.</p>
</div>
<div id="ref-clarkNFLCombine40Yard2017">
<p>Clark, Kenneth P., Randall H. Rieger, Richard F. Bruno, and David J. Stearne. 2017. “The NFL Combine 40-Yard Dash: How Important Is Maximum Velocity?” <em>Journal of Strength and Conditioning Research</em>, June, 1. <a href="https://doi.org/10.1519/JSC.0000000000002081">https://doi.org/10.1519/JSC.0000000000002081</a>.</p>
</div>
<div id="ref-edwardsSprintAccelerationCharacteristics2020">
<p>Edwards, Toby, Benjamin Piggott, Harry G. Banyard, G. Gregory Haff, and Christopher Joyce. 2020. “Sprint Acceleration Characteristics Across the Australian Football Participation Pathway.” <em>Sports Biomechanics</em>, August, 1–13. <a href="https://doi.org/10.1080/14763141.2020.1790641">https://doi.org/10.1080/14763141.2020.1790641</a>.</p>
</div>
<div id="ref-doi:10-1098/rspb-1927-0035">
<p>Furusawa, K., Archibald Vivian Hill, and J. L. Parkinson. 1927. “The Dynamics of "Sprint" Running.” <em>Proceedings of the Royal Society of London. Series B, Containing Papers of a Biological Character</em> 102 (713): 29–42. <a href="https://doi.org/10.1098/rspb.1927.0035">https://doi.org/10.1098/rspb.1927.0035</a>.</p>
</div>
<div id="ref-R-LambertW">
<p>Goerg, Georg M. 2020. <em>LambertW: Probabilistic Models to Analyze and Gaussianize Heavy-Tailed, Skewed Data</em>. <a href="https://CRAN.R-project.org/package=LambertW">https://CRAN.R-project.org/package=LambertW</a>.</p>
</div>
<div id="ref-haugenPowerForceVelocityProfilingSprinting2020">
<p>Haugen, Thomas A., Felix Breitschädel, and Pierre Samozino. 2020. “Power-Force-Velocity Profiling of Sprinting Athletes: Methodological and Practical Considerations When Using Timing Gates.” <em>Journal of Strength and Conditioning Research</em> 34 (6): 1769–73. <a href="https://doi.org/10.1519/JSC.0000000000002890">https://doi.org/10.1519/JSC.0000000000002890</a>.</p>
</div>
<div id="ref-haugenSprintMechanicalVariables2019">
<p>Haugen, Thomas A., Felix Breitschädel, and Stephen Seiler. 2019. “Sprint Mechanical Variables in Elite Athletes: Are Force-Velocity Profiles Sport Specific or Individual?” Edited by Leonardo A. Peyré-Tartaruga. <em>PLOS ONE</em> 14 (7): e0215551. <a href="https://doi.org/10.1371/journal.pone.0215551">https://doi.org/10.1371/journal.pone.0215551</a>.</p>
</div>
<div id="ref-haugenSprintMechanicalProperties2020">
<p>———. 2020. “Sprint Mechanical Properties in Soccer Players According to Playing Standard, Position, Age and Sex.” <em>Journal of Sports Sciences</em> 38 (9): 1070–6. <a href="https://doi.org/10.1080/02640414.2020.1741955">https://doi.org/10.1080/02640414.2020.1741955</a>.</p>
</div>
<div id="ref-haugenDifferenceStartImpact2012">
<p>Haugen, Thomas A, Espen Tønnessen, and Stephen K Seiler. 2012. “The Difference Is in the Start: Impact of Timing and Start Procedure on Sprint Running Performance:” <em>Journal of Strength and Conditioning Research</em> 26 (2): 473–79. <a href="https://doi.org/10.1519/JSC.0b013e318226030b">https://doi.org/10.1519/JSC.0b013e318226030b</a>.</p>
</div>
<div id="ref-jamesIntroductionStatisticalLearning2017">
<p>James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2017. <em>An Introduction to Statistical Learning: With Applications in R</em>. 1st ed. 2013, Corr. 7th printing 2017 edition. New York: Springer.</p>
</div>
<div id="ref-jimenez-reyesRelationshipVerticalHorizontal2018">
<p>Jiménez-Reyes, Pedro, Pierre Samozino, Amador García-Ramos, Víctor Cuadrado-Peñafiel, Matt Brughelli, and Jean-Benoît Morin. 2018. “Relationship Between Vertical and Horizontal Force-Velocity-Power Profiles in Various Sports and Levels of Practice.” <em>PeerJ</em> 6 (November): e5937. <a href="https://doi.org/10.7717/peerj.5937">https://doi.org/10.7717/peerj.5937</a>.</p>
</div>
<div id="ref-R-shorts">
<p>Jovanovic, Mladen. 2020. <em>Shorts: Short Sprints</em>. <a href="https://CRAN.R-project.org/package=shorts">https://CRAN.R-project.org/package=shorts</a>.</p>
</div>
<div id="ref-jovanovicBmbstatsBootstrapMagnitudebased2020">
<p>Jovanović, Mladen. 2020. <em>Bmbstats: Bootstrap Magnitude-Based Statistics for Sports Scientists</em>. Mladen Jovanović.</p>
</div>
<div id="ref-kuhnAppliedPredictiveModeling2018">
<p>Kuhn, Max, and Kjell Johnson. 2018. <em>Applied Predictive Modeling</em>. 1st ed. 2013, Corr. 2nd printing 2016 edition. New York: Springer.</p>
</div>
<div id="ref-mangineSpeedForcePower2014">
<p>Mangine, Gerald T., Jay R. Hoffman, Adam M. Gonzalez, Adam J. Wells, Jeremy R. Townsend, Adam R. Jajtner, William P. McCormack, et al. 2014. “Speed, Force, and Power Values Produced from Nonmotorized Treadmill Test Are Related to Sprinting Performance:” <em>Journal of Strength and Conditioning Research</em> 28 (7): 1812–9. <a href="https://doi.org/10.1519/JSC.0000000000000316">https://doi.org/10.1519/JSC.0000000000000316</a>.</p>
</div>
<div id="ref-marcote-pequenoAssociationForceVelocity2019">
<p>Marcote-Pequeño, Ramón, Amador García-Ramos, Víctor Cuadrado-Peñafiel, Jorge M. González-Hernández, Miguel Ángel Gómez, and Pedro Jiménez-Reyes. 2019. “Association Between the ForceVelocity Profile and Performance Variables Obtained in Jumping and Sprinting in Elite Female Soccer Players.” <em>International Journal of Sports Physiology and Performance</em> 14 (2): 209–15. <a href="https://doi.org/10.1123/ijspp.2018-0233">https://doi.org/10.1123/ijspp.2018-0233</a>.</p>
</div>
<div id="ref-morinSimpleMethodComputing2019">
<p>Morin, Jean-Benoit, Pierre Samozino, Munenori Murata, Matt R Cross, and Ryu Nagahara. 2019. “A Simple Method for Computing Sprint Acceleration Kinetics from Running Velocity Data: Replication Study with Improved Design.” <em>Journal of Biomechanics</em> 94 (September): 82–87. <a href="https://doi.org/10.1016/j.jbiomech.2019.07.020">https://doi.org/10.1016/j.jbiomech.2019.07.020</a>.</p>
</div>
<div id="ref-R-nlme">
<p>Pinheiro, José, Douglas Bates, and R-core. 2020. <em>Nlme: Linear and Nonlinear Mixed Effects Models</em>. <a href="https://svn.r-project.org/R-packages/trunk/nlme/">https://svn.r-project.org/R-packages/trunk/nlme/</a>.</p>
</div>
<div id="ref-R-base">
<p>R Core Team. 2020. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-samozinoSimpleMethodMeasuring2016">
<p>Samozino, P., G. Rabita, S. Dorel, J. Slawinski, N. Peyrot, E. Saez de Villarreal, and J.-B. Morin. 2016. “A Simple Method for Measuring Power, Force, Velocity Properties, and Mechanical Effectiveness in Sprint Running: Simple Method to Compute Sprint Mechanics.” <em>Scandinavian Journal of Medicine &amp; Science in Sports</em> 26 (6): 648–58. <a href="https://doi.org/10.1111/sms.12490">https://doi.org/10.1111/sms.12490</a>.</p>
</div>
<div id="ref-vaningenschenauCanCyclePower1991">
<p>van Ingen Schenau, Gerrit Jan, Ron Jacobs, and Jos J. de Koning. 1991. “Can Cycle Power Predict Sprint Running Performance?” <em>European Journal of Applied Physiology and Occupational Physiology</em> 63 (3-4): 255–60. <a href="https://doi.org/10.1007/BF00233857">https://doi.org/10.1007/BF00233857</a>.</p>
</div>
<div id="ref-vescoviSprintSpeedCharacteristics2012">
<p>Vescovi, Jason D. 2012. “Sprint Speed Characteristics of High-Level American Female Soccer Players: Female Athletes in Motion (FAiM) Study.” <em>Journal of Science and Medicine in Sport</em> 15 (5): 474–78. <a href="https://doi.org/10.1016/j.jsams.2012.03.006">https://doi.org/10.1016/j.jsams.2012.03.006</a>.</p>
</div>
<div id="ref-vescoviImpactMaximumSpeed2014">
<p>———. 2014. “Impact of Maximum Speed on Sprint Performance During High-Level Youth Female Field Hockey Matches: Female Athletes in Motion (FAiM) Study.” <em>International Journal of Sports Physiology and Performance</em> 9 (4): 621–26. <a href="https://doi.org/10.1123/ijspp.2013-0263">https://doi.org/10.1123/ijspp.2013-0263</a>.</p>
</div>
<div id="ref-vescoviLocomotorHeartRateMetabolic2016">
<p>———. 2016. “Locomotor, Heart-Rate, and Metabolic Power Characteristics of Youth Women’s Field Hockey: Female Athletes in Motion (FAiM) Study.” <em>Research Quarterly for Exercise and Sport</em> 87 (1): 68–77. <a href="https://doi.org/10.1080/02701367.2015.1124972">https://doi.org/10.1080/02701367.2015.1124972</a>.</p>
</div>
<div id="ref-ward-smithEnergyConversionStrategies2001">
<p>Ward-Smith, A. J. 2001. “Energy Conversion Strategies During 100 M Sprinting.” <em>Journal of Sports Sciences</em> 19 (9): 701–10. <a href="https://doi.org/10.1080/02640410152475838">https://doi.org/10.1080/02640410152475838</a>.</p>
</div>
<div id="ref-R-tidyverse">
<p>Wickham, Hadley. 2019. <em>Tidyverse: Easily Install and Load the Tidyverse</em>. <a href="https://CRAN.R-project.org/package=tidyverse">https://CRAN.R-project.org/package=tidyverse</a>.</p>
</div>
<div id="ref-R-tidyr">
<p>———. 2020. <em>Tidyr: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2020. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
<div id="ref-R-dplyr">
<p>Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2020. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mladen Jovanović.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
